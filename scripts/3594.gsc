// IW7 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

_id_1342F()
{

}

_id_13430()
{
    level endon( "game_ended" );
    self endon( "end_explode" );
    self.owner endon( "disconnect" );
    self waittill( "explode", var_0 );
    _id_10E0B( var_0, self.owner );
}

_id_10E0B( var_0, var_1 )
{
    var_2 = [];
    var_3 = scripts\mp\utility\game::_id_8027( var_1.team );
    var_2 = scripts\mp\utility\game::_id_807C( var_0, 256 );

    if ( var_2.size > 0 )
    {
        foreach ( var_5 in var_2 )
        {
            if ( !isagent( var_5 ) )
            {
                if ( var_5.team == var_3 || var_5 == var_1 )
                {
                    var_6 = _id_13431( var_2, var_5, self, var_0 );

                    if ( !var_6 )
                        continue;

                    var_5 thread _id_5AE9( var_1, var_3 );
                }
            }
        }
    }
}

_id_13431( var_0, var_1, var_2, var_3 )
{
    var_4 = scripts\engine\utility::_id_1756( var_0, var_2 );

    if ( !scripts\engine\trace::_id_DCF1( var_3, var_1.origin + ( 0, 0, 32 ), var_4 ) )
        return 0;

    return 1;
}

_id_5AE9( var_0, var_1 )
{
    thread _id_13BA1();

    if ( isdefined( self._id_8C3B ) && self._id_8C3B )
    {
        scripts\mp\utility\game::_id_E150( "specialty_block_health_regen" );
        self notify( "force_regen" );
        self notify( "virus_complete" );
    }

    self endon( "death" );
    self endon( "disconnect" );
    self endon( "virus_complete" );
    self._id_8C3B = 1;
    var_2 = 10;
    var_3 = 3;
    scripts\mp\utility\game::giveperk( "specialty_block_health_regen" );
    self iprintlnbold( "Systems infected by Virus!" );
    thread _id_D572();
    thread _id_D573();
    self _meth_80B0( 50, self.origin, var_0, undefined, "MOD_EXPLOSIVE", "virus_grenade_mp" );

    while ( var_3 > 0 )
    {
        playfx( scripts\engine\utility::_id_7ECB( "vfx_virus_active_3rd_person" ), self.origin + ( 0, 0, 32 ) );
        wait 0.5;
        var_3 = var_3 - 0.5;
        _id_10AA5( var_0, var_1 );
    }

    wait( var_2 );
    self iprintlnbold( "Virus purged, rebooting systems..." );
    self._id_8C3B = 0;
    scripts\mp\utility\game::_id_E150( "specialty_block_health_regen" );
    self notify( "force_regen" );
    self notify( "virus_complete" );
}

_id_D572()
{
    self endon( "death" );
    self endon( "disconnect" );
    self endon( "virus_complete" );
    var_0 = anglestoforward( self.angles );
    var_1 = anglestoup( self.angles );

    for (;;)
    {
        playfx( scripts\engine\utility::_id_7ECB( "vfx_virus_particles" ), self.origin + ( 0, 0, 32 ), var_0, var_1 );
        wait 0.1;
    }
}

_id_D573()
{
    self endon( "death" );
    self endon( "disconnect" );
    self endon( "virus_complete" );

    for (;;)
    {
        var_0 = spawnfxforclient( scripts\engine\utility::_id_7ECB( "vfx_virus_particles_screen" ), self geteye(), self );
        triggerfx( var_0 );
        var_0 thread scripts\mp\utility\game::_id_51C7( self );
        wait 0.2;
        var_0 delete();
    }
}

_id_10AA5( var_0, var_1 )
{
    var_2 = self.origin + ( 0, 0, 32 );
    var_3 = scripts\mp\utility\game::_id_807C( var_2, 256 );

    if ( var_3.size > 0 )
    {
        foreach ( var_5 in var_3 )
        {
            if ( !isagent( var_5 ) )
            {
                if ( var_5.team == var_1 )
                {
                    if ( isdefined( var_5._id_8C3B ) && !var_5._id_8C3B || !isdefined( var_5._id_8C3B ) )
                    {
                        var_6 = _id_13431( var_3, var_5, self, var_2 );

                        if ( !var_6 )
                            continue;

                        var_5 thread _id_5AE9( var_0, var_1 );
                    }
                }
            }
        }
    }
}

_id_13BA1()
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "player_spawned" );
    self waittill( "death" );

    if ( isdefined( self._id_8C3B ) )
        self._id_8C3B = undefined;
}
