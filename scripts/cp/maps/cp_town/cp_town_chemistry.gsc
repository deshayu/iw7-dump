// IW7 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    level.final_compounds = [];
    level.compounds = [];
    level._id_601E = [];
    level._id_DBFE = [];
    parse_compounds_table();
    setup_final_compound();
    parse_elements_table();
    parse_compound_vo_table();
    setup_blackboards();
    setup_constants();
    setup_eye_equation_constant();
    setup_pi_constant();
    setup_color_key_chart();
    setup_heat_pressure_equation_constant();
    setup_lab_screen();
    setup_chem_compound_slot_world_lua();
    setup_in_world_lua();
    level thread setup_chemical_object_interactions();
    level thread setup_heat_pressure_buttons();
    level thread setup_chemistry_lab_models_in_world();
    level thread setup_beaker_and_compounds();
    level thread setup_discard_player_chemical_interaction();
    level.quest_pillage_give_func = ::chem_radio_battery_pickup;
}

setup_beaker_and_compounds()
{
    scripts\engine\utility::_id_6E4C( "interactions_initialized" );
    wait 10;

    foreach ( var_1 in level.chemical_containers )
        var_1._id_9A09 = create_beaker_interaction( var_1 );

    foreach ( var_4 in level.chemical_compounds_created )
        var_4._id_9A09 = create_compound_interaction( var_4 );
}

create_beaker_interaction( var_0 )
{
    var_1 = spawnstruct();
    var_1.script_noteworthy = var_0.name;
    var_1.origin = var_0._id_01F1.origin;
    var_1.angles = var_0._id_01F1.angles;
    var_1._id_E1B9 = 0;
    var_1._id_D776 = 1;
    var_1._id_EE79 = "beaker_interactions";
    var_1.name = var_0.name;
    var_1._id_109DA = undefined;
    var_1._id_46A2 = 0;
    var_1.chemical_contained = var_0.chemical_contained;
    var_1._id_01F1 = var_0._id_01F1;
    var_1._id_8FFA = ::beaker_hint_func;
    var_1._id_161A = ::add_element_to_beaker_interaction;
    var_1._id_6261 = 1;
    var_1.disable_guided_interactions = 1;
    level._id_9A43[var_1.name] = var_1;
    _id_0A59::_id_175C( var_1 );
    return var_1;
}

setup_discard_player_chemical_interaction()
{
    scripts\engine\utility::_id_6E4C( "interactions_initialized" );
    wait 10;
    var_0 = spawnstruct();
    var_0.script_noteworthy = "discard_chem_interaction";
    var_0.origin = ( 4617.5, 1510.5, 336 );
    var_0.angles = ( 0, 0, 0 );
    var_0._id_E1B9 = 0;
    var_0._id_D776 = 1;
    var_0._id_EE79 = "discard_chem_interaction";
    var_0.name = "discard_chem_interaction";
    var_0._id_109DA = undefined;
    var_0._id_46A2 = 0;
    var_0._id_8FFA = ::discard_hint_func;
    var_0._id_161A = ::discard_chemical_from_player;
    var_0._id_6261 = 1;
    var_0.disable_guided_interactions = 1;
    level._id_9A43[var_0.name] = var_0;
    _id_0A59::_id_175C( var_0 );
    level.discard_chem_interaction = var_0;
}

discard_chemical_from_player( var_0, var_1 )
{
    set_chemical_carried_by_player_after_beaker_deposit( var_1, "" );
}

discard_hint_func( var_0, var_1 )
{
    if ( isdefined( var_1.chemical_base_picked ) && var_1.chemical_base_picked != "" )
        return &"CP_TOWN_DISCARD_ONLY";
    else
        return "";
}

beaker_hint_func( var_0, var_1 )
{
    if ( isdefined( var_1.chemical_base_picked ) && var_1.chemical_base_picked != "" )
    {
        if ( var_0.chemical_contained == "" )
            return &"CP_TOWN_CHEM_PLACE_DISCARD";
        else
            return &"CP_TOWN_SWAP_DISCARD";
    }
    else
        return "";
}

compound_hint_func( var_0, var_1 )
{
    if ( var_0.compound_contained != "" )
        return &"CP_TOWN_ADD_COMPOUND";
    else
        return "";
}

create_compound_interaction( var_0 )
{
    var_1 = spawnstruct();
    var_1.script_noteworthy = var_0.name;
    var_1.origin = var_0._id_01F1.origin;
    var_1.angles = var_0._id_01F1.angles;
    var_1.compound_contained = var_0.compound_contained;
    var_1.compound_container_filled = var_0.compound_container_filled;
    var_1._id_01F1 = var_0._id_01F1;
    var_1._id_E1B9 = 0;
    var_1._id_D776 = 1;
    var_1._id_EE79 = "compound_interactions";
    var_1.name = var_0.name;
    var_1._id_109DA = undefined;
    var_1._id_46A2 = 0;
    var_1._id_8FFA = ::compound_hint_func;
    var_1._id_161A = ::add_compounds_interaction;
    var_1._id_6261 = 1;
    var_1.disable_guided_interactions = 1;
    level._id_9A43[var_1.name] = var_1;
    _id_0A59::_id_175C( var_1 );
    return var_1;
}

chem_radio_battery_pickup( var_0 )
{
    var_0 setclientomnvar( "zm_nag_text", 1 );
    var_0.has_battery = 1;
}

setup_chemistry_lab_models_in_world()
{
    var_0 = getentarray( "chemistry_set_parts", "script_noteworthy" );

    foreach ( var_3, var_2 in var_0 )
    {
        var_2 hide();
        level.chemistry_set_parts[var_3] = var_2;
    }
}

setup_heat_pressure_buttons()
{
    var_0 = scripts\engine\utility::_id_8180( "h_p_button", "script_noteworthy" );
    var_1 = getent( "chem_computer", "targetname" );

    foreach ( var_6, var_3 in var_0 )
    {
        var_4 = undefined;

        switch ( var_3.name )
        {
            case "h_p_button_1":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_1" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_2":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_2" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_3":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_3" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_4":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_4" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_5":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_5" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_6":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_6" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_7":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_7" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_8":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_8" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_9":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_9" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            case "h_p_button_0":
                var_4 = spawn( "script_model", var_1 gettagorigin( "tag_button_0" ) );
                var_4 setmodel( "cp_town_chem_lab_computer_interactive_button" );
                var_4.angles = var_3.angles;
                break;
            default:
        }

        var_5 = strtok( var_3.name, "_" );
        var_3.numeric_value = int( var_5[3] );

        if ( isdefined( var_4 ) )
            var_3._id_01F1 = var_4;

        var_3._id_01F1 hide();
        level.h_p_button_objects[var_6] = var_3;
    }
}

update_player_monitor_buttons( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );

    for (;;)
    {
        scripts\engine\utility::waitframe();

        if ( scripts\engine\utility::_id_9CEE( self._id_9D81 ) )
            continue;

        if ( distancesquared( self.origin, ( 4760, 1546, 336 ) ) > 5184 )
            continue;

        update_button_state_for_player( self, var_0 );
    }
}

update_button_state_for_player( var_0, var_1 )
{
    var_0 endon( "disconnect" );

    if ( distance2dsquared( var_1.origin, var_0.origin ) > 6400 )
    {
        var_1._id_01F1 _meth_818C( var_0 );
        return;
    }

    if ( !var_0 _meth_8409( var_1.origin, 15, 80 ) )
    {
        var_1._id_01F1 _meth_818C( var_0 );
        scripts\engine\utility::waitframe();
        return;
    }

    level thread show_hint_for_time( 2, var_0 );
    var_1._id_01F1 _meth_818F( var_0, 3, 1, 0 );
}

show_hint_for_time( var_0, var_1 )
{
    var_1 endon( "disconnect" );
    var_1 notify( "end_thread_instance" );
    var_1 endon( "end_thread_instance" );
    var_1 _meth_80F4( &"CP_TOWN_INTERACTIONS_PUSH_BOMB" );
    wait( var_0 );
    var_1 _meth_80F3();
}

watch_for_input_entered_on_button( var_0 )
{
    self endon( "disconnect" );
    self notifyonplayercommand( "select_button", "+usereload" );
    self notifyonplayercommand( "select_button", "+activate" );
    var_1 = "";

    for (;;)
    {
        var_1 = scripts\engine\utility::_id_13734( "select_button" );

        if ( distance2dsquared( var_0.origin, self.origin ) > 6400 )
        {
            var_0._id_01F1 _meth_818C( self );
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( !self _meth_8409( var_0.origin, 15, 80 ) )
        {
            var_0._id_01F1 _meth_818C( self );
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( !isdefined( var_1 ) )
        {
            var_0._id_01F1 _meth_818C( self );
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( !scripts\engine\utility::_id_9CEE( level.crafted_chem_set ) )
        {
            scripts\engine\utility::waitframe();
            continue;
        }

        var_0._id_01F1 _meth_818F( self, 3, 1, 0 );

        if ( var_1 == "select_button" )
        {
            self _meth_8441( "ges_point_gun", var_0._id_01F1 );
            add_button_value_to_list( var_0, self );
            scripts\engine\utility::_id_CE2B( "chemistry_machine_button_press", var_0.origin );
            wait 1;
            var_0._id_01F1 _meth_818C( self );
        }
    }
}

add_button_value_to_list( var_0, var_1 )
{
    if ( !isdefined( level.h_p_buttons_value ) )
        level.h_p_buttons_value = [];

    if ( !isdefined( level.buttons_pointer ) )
        level.buttons_pointer = 0;

    if ( level.buttons_pointer > 1 )
    {
        level.buttons_pointer = 0;
        level.h_p_buttons_value = [];
        setomnvar( "zm_chem_number_entry_1", -1 );
    }

    level.h_p_buttons_value[level.buttons_pointer] = var_0.numeric_value;

    if ( isdefined( level.h_p_buttons_value[1] ) )
    {
        level.heat_pressure_machine_value = 10 * level.h_p_buttons_value[0] + level.h_p_buttons_value[1];
        setomnvar( "zm_chem_number_entry_2", 2 );
    }
    else
    {
        level.heat_pressure_machine_value = level.h_p_buttons_value[0];
        setomnvar( "zm_chem_number_entry_2", 1 );
    }

    setomnvar( "zm_chem_number_entry_1", level.heat_pressure_machine_value );
    level.buttons_pointer++;
}

setup_chemical_object_interactions()
{
    scripts\engine\utility::_id_6E4C( "interactions_initialized" );

    foreach ( var_2, var_1 in level._id_601E )
    {
        if ( var_2 == "animalfat" || var_2 == "silver" || var_2 == "copper" || var_2 == "chill" )
            continue;

        if ( level._id_601E[var_2].type == "componant" || level._id_601E[var_2].type == "final" )
            continue;

        var_1._id_9A09 = create_chemical_object_interaction( var_1 );
    }
}

parse_compounds_table()
{
    if ( isdefined( level.compound_table ) )
        var_0 = level.compound_table;
    else
        var_0 = "cp/zombies/compounds.csv";

    var_1 = 0;

    for (;;)
    {
        var_2 = tablelookupbyrow( var_0, var_1, 0 );

        if ( var_2 == "" )
            break;

        var_3 = tablelookupbyrow( var_0, var_1, 1 );
        var_4 = tablelookupbyrow( var_0, var_1, 2 );
        var_5 = tablelookupbyrow( var_0, var_1, 3 );
        var_6 = tablelookupbyrow( var_0, var_1, 4 );
        var_7 = tablelookupbyrow( var_0, var_1, 5 );
        var_8 = tablelookupbyrow( var_0, var_1, 6 );
        register_compound( var_2, var_3, var_4, var_5, var_6, var_7, var_8 );
        var_1++;
    }
}

register_compound( var_0, var_1, var_2, var_3, var_4, var_5, var_6 )
{
    var_7 = spawnstruct();
    var_7.displayname = var_1;
    var_7.type = var_2;

    if ( var_7.type == "final" )
        level.final_compounds[level.final_compounds.size] = var_0;

    var_7.parta = var_3;
    var_7.partb = var_4;
    var_7.partc = var_5;
    var_7.partd = var_6;
    level.compounds[var_0] = var_7;
}

parse_elements_table()
{
    if ( isdefined( level.element_table ) )
        var_0 = level.element_table;
    else
        var_0 = "cp/zombies/elements.csv";

    var_1 = 0;

    for (;;)
    {
        var_2 = tablelookupbyrow( var_0, var_1, 1 );

        if ( var_2 == "" )
            break;

        var_3 = tablelookupbyrow( var_0, var_1, 0 );
        var_4 = tablelookupbyrow( var_0, var_1, 2 );
        var_5 = tablelookupbyrow( var_0, var_1, 3 );
        var_6 = tablelookupbyrow( var_0, var_1, 4 );
        var_7 = tablelookupbyrow( var_0, var_1, 6 );
        var_8 = tablelookupbyrow( var_0, var_1, 7 );
        var_9 = tablelookupbyrow( var_0, var_1, 8 );
        var_10 = tablelookupbyrow( var_0, var_1, 9 );
        var_11 = tablelookupbyrow( var_0, var_1, 10 );
        var_12 = tablelookupbyrow( var_0, var_1, 11 );
        var_13 = tablelookupbyrow( var_0, var_1, 12 );
        var_14 = tablelookupbyrow( var_0, var_1, 13 );
        var_15 = tablelookupbyrow( var_0, var_1, 14 );
        var_16 = tablelookupbyrow( var_0, var_1, 15 );
        var_17 = tablelookupbyrow( var_0, var_1, 16 );
        var_18 = tablelookupbyrow( var_0, var_1, 17 );
        var_19 = tablelookupbyrow( var_0, var_1, 18 );
        var_20 = tablelookupbyrow( var_0, var_1, 19 );
        var_21 = tablelookupbyrow( var_0, var_1, 32 );
        var_22 = tablelookupbyrow( var_0, var_1, 33 );
        var_23 = tablelookupbyrow( var_0, var_1, 34 );
        register_element( var_3, var_2, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11, var_12, var_13, var_14, var_15, var_16, var_17, var_18, var_19, var_20, var_21, var_22, var_23 );
        var_1++;
    }
}

register_element( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11, var_12, var_13, var_14, var_15, var_16, var_17, var_18, var_19, var_20, var_21 )
{
    var_22 = spawnstruct();
    var_22._id_C4A1 = var_0;
    var_22.displayname = var_2;
    var_22.unique = var_4;
    var_22._id_01F1 = var_5;
    var_22.type = var_3;
    var_22._id_10307 = var_6;
    var_22.valuesets = spawnstruct();
    var_22.valuesets.choicea = spawnstruct();
    var_22.valuesets.choicea._id_8CD0 = var_7;
    var_22.valuesets.choicea.pressure = var_8;
    var_22.valuesets.choiceb = spawnstruct();
    var_22.valuesets.choiceb._id_8CD0 = var_9;
    var_22.valuesets.choiceb.pressure = var_10;
    var_22.valuesets.choicec = spawnstruct();
    var_22.valuesets.choicec._id_8CD0 = var_11;
    var_22.valuesets.choicec.pressure = var_12;
    var_22.valuesets.choiced = spawnstruct();
    var_22.valuesets.choiced._id_8CD0 = var_13;
    var_22.valuesets.choiced.pressure = var_14;
    var_22.valuesets.choicee = spawnstruct();
    var_22.valuesets.choicee._id_8CD0 = var_15;
    var_22.valuesets.choicee.pressure = var_16;
    var_22.valuesets.choicef = spawnstruct();
    var_22.valuesets.choicef._id_8CD0 = var_17;
    var_22.valuesets.choicef.pressure = var_18;
    var_22.model_coordinates = var_19;
    var_22.model_angles = var_20;
    var_22._id_10475 = var_21;

    if ( var_3 == "componant" || var_3 == "final" )
    {
        if ( var_3 == "componant" )
        {
            var_23 = scripts\engine\utility::_id_DC6B( [ level._effect["beaker_chem_blue"], level._effect["beaker_chem_orange"], level._effect["beaker_chem_pink"], level._effect["beaker_chem_purple"] ] );
            var_22.fx_trigger = var_23;
        }
        else
            var_22.fx_trigger = level._effect["beaker_chem_red"];

        level._id_601E[var_1] = var_22;
    }
    else if ( var_1 == "animalfat" )
    {
        level.animalfat = [];
        var_24 = strtok( var_22.model_coordinates, "," );
        var_25 = scripts\engine\utility::_id_817E( "cp_town_animal_fat", "script_noteworthy" );
        var_26 = spawn( "script_model", var_25.origin );
        var_26 setmodel( "tag_origin_chemical" );
        var_26.angles = ( 0, 0, 0 );
        var_26 setcandamage( 1 );
        var_26.maxhealth = 5;
        var_26.health = 5;
        var_25._id_01F1 = var_26;
        var_25.chemical_object_name = var_1;
        level.animalfat[level.animalfat.size] = var_25._id_01F1;
        var_25 thread watch_for_melee_on_chemical_object();
        level._id_601E[var_1] = var_22;
    }
    else if ( var_1 == "copper" )
    {
        level.silver = [];
        var_27 = scripts\engine\utility::_id_8180( "cp_town_pennies", "script_noteworthy" );

        foreach ( var_29 in var_27 )
        {
            var_26 = spawn( "script_model", var_29.origin );
            var_26 setmodel( "tag_origin_chemical" );
            var_26.angles = var_29.angles;
            var_26 setcandamage( 1 );
            var_26.maxhealth = 5;
            var_26.health = 5;
            var_29._id_01F1 = var_26;
            var_29.chemical_object_name = var_1;
            level.silver[level.silver.size] = var_29._id_01F1;
            var_29 thread watch_for_melee_on_chemical_object();
        }

        level._id_601E[var_1] = var_22;
    }
    else if ( var_1 == "silver" )
    {
        level.copper = [];
        var_31 = scripts\engine\utility::_id_8180( "cp_town_quarters", "script_noteworthy" );
        var_32 = spawnstruct();
        var_32.origin = ( 5270, 1596, 387 );
        var_32.angles = ( 10, 184, 0 );
        var_33 = spawnstruct();
        var_33.origin = ( 5265, 1637, 387 );
        var_33.angles = ( 10, 184, 0 );
        var_31 = scripts\engine\utility::_id_1756( var_31, var_32 );
        var_31 = scripts\engine\utility::_id_1756( var_31, var_33 );

        foreach ( var_29 in var_31 )
        {
            var_26 = spawn( "script_model", var_29.origin );
            var_26 setmodel( "tag_origin_chemical" );
            var_26.angles = var_29.angles;
            var_26 setcandamage( 1 );
            var_26.maxhealth = 5;
            var_26.health = 5;
            var_29._id_01F1 = var_26;
            var_29.chemical_object_name = var_1;
            level.copper[level.copper.size] = var_29._id_01F1;
            var_29 thread watch_for_melee_on_chemical_object();
        }

        level._id_601E[var_1] = var_22;
    }
    else if ( var_1 == "chill" )
    {
        var_26 = undefined;
        level._id_3E69 = [];
        var_36 = scripts\engine\utility::_id_8180( "cp_town_chill", "script_noteworthy" );

        foreach ( var_29 in var_36 )
        {
            var_26 = spawn( "script_model", var_29.origin );
            var_26 setmodel( "tag_origin_chemical" );
            var_26.angles = var_29.angles;
            var_26 setcandamage( 1 );
            var_26.maxhealth = 5;
            var_26.health = 5;
            var_29._id_01F1 = var_26;
            var_29.chemical_object_name = var_1;
            level._id_3E69[level._id_3E69.size] = var_29._id_01F1;
            var_29 thread watch_for_melee_on_chemical_object();
        }

        level._id_601E[var_1] = var_22;
    }
    else
    {
        var_24 = strtok( var_22.model_coordinates, "," );
        var_22.chemical_model_object = spawn( "script_model", ( int( var_24[0] ), int( var_24[1] ), int( var_24[2] ) ) );
        var_22.chemical_model_object setmodel( var_22._id_01F1 );
        var_39 = strtok( var_22.model_angles, "," );
        var_22.chemical_model_object.angles = ( int( var_39[0] ), int( var_39[1] ), int( var_39[2] ) );
        var_22.chemical_object_name = var_1;
        level._id_601E[var_1] = var_22;
    }
}

setup_radio_vo_from_elements()
{
    if ( isdefined( level.element_table ) )
        var_0 = level.element_table;
    else
        var_0 = "cp/zombies/elements.csv";

    var_1 = 0;

    for (;;)
    {
        var_2 = tablelookupbyrow( var_0, var_1, 1 );

        if ( var_2 == "" )
            break;

        var_3 = tablelookupbyrow( var_0, var_1, 3 );
        var_4 = tablelookupbyrow( var_0, var_1, 4 );
        var_5 = tablelookupbyrow( var_0, var_1, 7 );
        var_6 = tablelookupbyrow( var_0, var_1, 34 );
        register_radio_vo( var_2, var_3, var_4, var_5, var_6 );
        var_1++;
    }
}

register_radio_vo( var_0, var_1, var_2, var_3, var_4 )
{
    if ( var_0 == "chill" )
        return;

    switch ( var_3 )
    {
        case "5":
            var_5 = level.chem_radio_1_sounds.size;
            level.chem_radio_1_sounds[var_5] = var_4;
            break;
        case "2":
            var_5 = level.chem_radio_2_sounds.size;
            level.chem_radio_2_sounds[var_5] = var_4;
            break;
        case "3":
            var_5 = level.chem_radio_3_sounds.size;
            level.chem_radio_3_sounds[var_5] = var_4;
            break;
        case "4":
            var_5 = level.chem_radio_4_sounds.size;
            level.chem_radio_4_sounds[var_5] = var_4;
            break;
        case "1":
            var_5 = level.chem_radio_5_sounds.size;
            level.chem_radio_5_sounds[var_5] = var_4;
            break;
        case "6":
            var_5 = level.chem_radio_6_sounds.size;
            level.chem_radio_6_sounds[var_5] = var_4;
            break;
    }
}

watch_for_melee_on_chemical_object()
{
    for (;;)
    {
        self._id_01F1 waittill( "damage", var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9 );

        if ( !isplayer( var_1 ) )
            continue;

        if ( self.chemical_object_name == "animalfat" && !issubstr( var_9, "cleaver" ) )
            continue;
        else if ( self.chemical_object_name == "silver" && !issubstr( var_9, "crowbar" ) )
            continue;
        else if ( self.chemical_object_name == "copper" && !issubstr( var_9, "crowbar" ) )
            continue;

        playfx( level._effect["sb_quest_item_pickup"], var_3 );
        var_10 = get_chemistry_object_value( self, 0 );
        var_11 = get_chemical_carried_by_player( var_1 );

        if ( var_11 == "" )
            set_chemical_carried_by_player( var_1, var_10 );
        else
            set_chemical_carried_by_player( var_1, var_10 );

        if ( self._id_01F1.health < 0 )
        {
            self._id_01F1.health = 5;
            self._id_01F1.maxhealth = 5;
        }
    }
}

create_chemical_object_interaction( var_0 )
{
    var_1 = spawnstruct();
    var_1.script_noteworthy = "element_pickup";

    if ( var_0.chemical_object_name == "sulfuricacid" )
        var_1.origin = var_0.chemical_model_object.origin + ( 60, -31, 21 );
    else
    {
        var_1.origin = var_0.chemical_model_object.origin;
        var_1.angles = var_0.chemical_model_object.angles;
    }

    var_1._id_E1B9 = 0;
    var_1._id_D776 = 1;
    var_1._id_EE79 = "element_pickup";
    var_1.name = "element_pickup";
    var_1.chemical_model_object = var_0.chemical_model_object;
    var_1._id_109DA = undefined;
    var_1._id_46A2 = 0;
    var_1.chemical_object_name = var_0.chemical_object_name;
    var_1._id_8FFA = ::element_pickup_hint_func;
    var_1._id_161A = ::try_play_swap_vfx;
    var_1._id_6261 = 1;
    var_1.disable_guided_interactions = 1;
    level._id_9A43[var_1.name] = var_1;
    _id_0A59::_id_175C( var_1 );
    return var_1;
}

setup_blackboards()
{
    level.blackboard_array = getentarray( "blackboard_model", "script_noteworthy" );
    level.blackboard_1_ent = undefined;
    level.blackboard_2_ent = undefined;
    level.blackboard_3_num = undefined;
    level.blackboard_4_ent = undefined;
    level.blackboard_5_ent = undefined;
    level.blackboard_6_ent = undefined;

    foreach ( var_1 in level.blackboard_array )
    {
        switch ( var_1.name )
        {
            case "blackboard_1":
                level.blackboard_1_ent = var_1;
                break;
            case "blackboard_2":
                level.blackboard_2_ent = var_1;
                break;
            case "blackboard_3":
                level.blackboard_3_ent = var_1;
                break;
            case "blackboard_4":
                level.blackboard_4_ent = var_1;
                break;
            case "blackboard_5":
                level.blackboard_5_ent = var_1;
                break;
            case "blackboard_6":
                level.blackboard_6_ent = var_1;
                break;
        }
    }
}

setup_in_world_lua()
{
    setomnvar( "zm_ui_blackboard_1_ent", level.blackboard_1_ent );
    setomnvar( "zm_ui_blackboard_2_ent", level.blackboard_2_ent );
    setomnvar( "zm_ui_blackboard_3_ent", level.blackboard_3_ent );
    setomnvar( "zm_ui_blackboard_4_ent", level.blackboard_4_ent );
    setomnvar( "zm_ui_blackboard_5_ent", level.blackboard_5_ent );
    setomnvar( "zm_ui_blackboard_6_ent", level.blackboard_6_ent );
    setomnvar( "zm_ui_constant_1_ent", level.constant_1_ent );
    setomnvar( "zm_ui_constant_2_ent", level.constant_2_ent );
    setomnvar( "zm_ui_constant_3_ent", level.constant_3_ent );
    setomnvar( "zm_ui_constant_4_ent", level.constant_4_ent );
    setomnvar( "zm_ui_pi_ent", level.pi_const );
    setomnvar( "zm_ui_eye_equation_ent", level.eye_equation );
    setomnvar( "zm_ui_reaction_equation_ent", level.heat_pressure_eq );
    setomnvar( "zm_chem_compound_slot_1_ent", level.chem_compound_slot_1_ent );
    setomnvar( "zm_chem_compound_slot_2_ent", level.chem_compound_slot_2_ent );
    setomnvar( "zm_chem_compound_slot_3_ent", level.chem_compound_slot_3_ent );
    setomnvar( "zm_chem_compound_slot_4_ent", level.chem_compound_slot_4_ent );
}

setup_chem_compound_slot_world_lua()
{
    level.chem_compound_slot_array = getentarray( "created_compound_name", "script_noteworthy" );
    level.chem_compound_slot_1_ent = undefined;
    level.chem_compound_slot_2_ent = undefined;
    level.chem_compound_slot_3_ent = undefined;
    level.chem_compound_slot_4_ent = undefined;

    foreach ( var_1 in level.chem_compound_slot_array )
    {
        switch ( var_1.name )
        {
            case "created_compound_name_1":
                level.chem_compound_slot_1_ent = var_1;
                break;
            case "created_compound_name_2":
                level.chem_compound_slot_2_ent = var_1;
                break;
            case "created_compound_name_3":
                level.chem_compound_slot_3_ent = var_1;
                break;
            case "created_compound_name_4":
                level.chem_compound_slot_4_ent = var_1;
                break;
        }
    }
}

setup_constants()
{
    level.constant_array = getentarray( "chem_const_1", "script_noteworthy" );
    level.constant_1_ent = undefined;
    level.constant_2_ent = undefined;
    level.constant_3_num = undefined;
    level.constant_4_ent = undefined;

    foreach ( var_1 in level.constant_array )
    {
        switch ( var_1.name )
        {
            case "chem_const_diamond_1":
                level.constant_1_ent = var_1;
                break;
            case "chem_const_diamond_2":
                level.constant_2_ent = var_1;
                break;
            case "chem_const_diamond_3":
                level.constant_3_ent = var_1;
                break;
            case "chem_const_diamond_4":
                level.constant_4_ent = var_1;
                break;
        }
    }
}

setup_diamond_constant_player_omnvars( var_0 )
{
    var_0 setclientomnvar( "zm_ui_constant_1_ent", level.constant_1_ent );
    var_0 setclientomnvar( "zm_ui_constant_2_ent", level.constant_2_ent );
    var_0 setclientomnvar( "zm_ui_constant_3_ent", level.constant_3_ent );
    var_0 setclientomnvar( "zm_ui_constant_4_ent", level.constant_4_ent );
}

setup_pi_constant()
{
    level.pi_const = getent( "chem_const_2", "script_noteworthy" );
}

setup_eye_equation_constant()
{
    level.eye_equation = getent( "chem_const_3", "script_noteworthy" );
}

setup_color_key_chart()
{
    level.color_eye = getent( "chem_const_tv_screen", "script_noteworthy" );
}

setup_heat_pressure_equation_constant()
{
    level.heat_pressure_eq = getent( "chem_const_equation", "script_noteworthy" );
}

setup_lab_screen()
{
    level.lab_screen = getent( "chem_const_lab_screen", "script_noteworthy" );
}

init_chem_reaction_interactions()
{
    init_beakers();
    init_compound_storage_objects();
    init_reaction_start_interactable_model();
    level.heat_pressure_machine_value = 0;
}

init_reaction_start_interactable_model()
{
    var_0 = scripts\engine\utility::_id_817E( "reaction_start_model", "script_noteworthy" );
    var_1 = spawn( "script_model", var_0.origin );
    var_1 setmodel( "tag_origin" );
    var_0._id_01F1 = var_1;
    level.reaction_start_model = var_0;
}

update_player_monitor_reaction_start( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );

    for (;;)
    {
        if ( distance2dsquared( var_0.origin, self.origin ) > 6400 )
        {
            wait 0.05;
            continue;
        }
        else
            update_reaction_button_state_for_player( self, var_0 );

        scripts\engine\utility::waitframe();
    }
}

update_reaction_button_state_for_player( var_0, var_1 )
{
    if ( distance2dsquared( var_1.origin, var_0.origin ) > 6400 )
        return;

    if ( !var_0 _meth_8409( var_1.origin, 25, 80 ) )
        return;

    show_reaction_hint_for_time( 2, var_0 );
}

show_reaction_hint_for_time( var_0, var_1 )
{
    var_1 endon( "disconnect" );
    var_1 notify( "end_thread_instance" );
    var_1 endon( "end_thread_instance" );
    var_1 _meth_80F4( &"CP_TOWN_INTERACTIONS_START_REACTION" );
    wait( var_0 );
    var_1 _meth_80F3();
}

watch_for_reaction_start_pressed( var_0 )
{
    self endon( "disconnect" );

    for (;;)
    {
        if ( !self usebuttonpressed() )
        {
            wait 0.05;
            continue;
        }

        if ( player_use_reaction_start_struct( var_0, self ) )
        {
            reaction_activation( var_0, self );
            wait 0.5;
        }

        wait 0.5;
    }
}

player_use_reaction_start_struct( var_0, var_1 )
{
    if ( !isdefined( var_0._id_01F1 ) )
        return 0;

    if ( distance2dsquared( var_0._id_01F1.origin, var_1.origin ) > 4900 )
        return 0;

    if ( !var_1 _meth_8409( var_0._id_01F1.origin, 65, 70 ) )
        return 0;

    return 1;
}

play_failure_fx( var_0 )
{
    var_0 thread watch_for_disconnect_player();
    var_0 endon( "disconnect" );

    foreach ( var_2 in level.chemical_containers )
        playfx( level._effect["fail_reaction_fx"], var_2._id_9A09._id_01F1.origin );

    scripts\engine\utility::waitframe();
    playfxontagforclients( level._effect["fail_reaction_screenfx"], var_0, "tag_eye", var_0 );
    level.computer_model setscriptablepartstate( "redlight", "on" );
    level.computer_model setscriptablepartstate( "yellowlight", "off" );
    wait 6;
    _func_297( level._effect["fail_reaction_screenfx"], var_0, "tag_eye", var_0 );
    level.computer_model setscriptablepartstate( "redlight", "off" );
    level.computer_model setscriptablepartstate( "yellowlight", "on" );
}

watch_for_disconnect_player()
{
    self waittill( "disconnect" );
    _func_297( level._effect["fail_reaction_screenfx"], self, "tag_eye", self );
    level.computer_model setscriptablepartstate( "redlight", "off" );
    level.computer_model setscriptablepartstate( "yellowlight", "on" );
}

play_success_fx( var_0 )
{
    var_0 endon( "disconnect" );
    playfxontagforclients( level._effect["success_reaction_screenfx"], var_0, "tag_eye", var_0 );
    level.computer_model setscriptablepartstate( "greenlight", "on" );
    level.computer_model setscriptablepartstate( "yellowlight", "off" );
    wait 6;
    _func_297( level._effect["success_reaction_screenfx"], var_0, "tag_eye", var_0 );
    level.computer_model setscriptablepartstate( "greenlight", "off" );
    level.computer_model setscriptablepartstate( "yellowlight", "on" );
}

watch_for_player_interaction_with_reaction_storage( var_0 )
{
    for (;;)
    {
        if ( !isdefined( level.players ) )
        {
            wait 1;
            continue;
        }
        else
            break;
    }

    foreach ( var_2 in level.players )
        var_2 thread watch_for_input_entered_on_reaction_storage( var_0 );
}

watch_for_input_entered_on_reaction_storage( var_0 )
{
    self notifyonplayercommand( "add_swap_compound", "+usereload" );
    self notifyonplayercommand( "discard_reaction", "+actionslot 4" );
    var_1 = "";

    for (;;)
    {
        var_1 = scripts\engine\utility::_id_13734( "add_swap_compound", "discard_reaction" );

        if ( distance2dsquared( var_0._id_01F1.origin, self.origin ) > 6400 )
        {
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( !self _meth_8409( var_0._id_01F1.origin, 65, 80 ) )
        {
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( !isdefined( var_1 ) )
        {
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( var_1 == "add_swap_compound" )
        {
            add_swap_compound( var_0, self );
            wait 1;
            continue;
        }

        if ( var_1 == "discard_reaction" )
        {
            discard_reaction_contents( var_0, self );
            wait 1;
        }
    }
}

discard_reaction_contents( var_0, var_1 )
{
    if ( isdefined( var_0.compound_contained ) && var_0.compound_contained != "" )
    {
        var_0.compound_contained = "";

        if ( isdefined( var_0.filled_fx ) )
            var_0.filled_fx delete();
    }
    else
    {

    }
}

add_swap_compound( var_0, var_1 )
{
    var_2 = get_compound_object_value( var_0 );
    var_3 = get_chemical_carried_by_player( var_1 );

    if ( var_2 == "" && var_3 == "" )
        return;
    else if ( var_2 != "" )
    {
        set_chemical_carried_by_player( var_1, var_2 );

        if ( var_2 == level.bomb_compound.name )
        {
            scripts\engine\utility::_id_6E3E( "chemistry_step3" );
            var_1 thread _id_0A6A::_id_12885( "key_phase_2_collect_mixture", "town_comment_vo" );
        }

        playfx( level._effect["sb_quest_item_pickup"], var_0._id_01F1.origin );
    }
}

reaction_activation( var_0, var_1 )
{
    var_2 = "";
    var_3 = 0;
    scripts\engine\utility::_id_CE2B( "chemistry_machine_button_press", var_0.origin );
    var_4 = level.constant_value;
    var_5 = 0;
    var_6 = 0;
    var_7 = 0;

    foreach ( var_10, var_9 in level.chemical_containers )
    {
        if ( var_9._id_9A09.chemical_contained == "" )
            continue;

        if ( var_9._id_9A09.chemical_contained == level.bomb_compound.name )
        {
            var_5 = var_5 + -100;
            var_6 = var_6 + -100;
        }

        switch ( level.bomb_compound.choice )
        {
            case 1:
                var_5 = var_5 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 8 ) );
                var_6 = var_6 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 9 ) );
                break;
            case 2:
                var_5 = var_5 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 10 ) );
                var_6 = var_6 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 11 ) );
                break;
            case 3:
                var_5 = var_5 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 12 ) );
                var_6 = var_6 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 13 ) );
                break;
            case 4:
                var_5 = var_5 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 14 ) );
                var_6 = var_6 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 15 ) );
                break;
            case 5:
                var_5 = var_5 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 16 ) );
                var_6 = var_6 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 17 ) );
                break;
            case 6:
                var_5 = var_5 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 18 ) );
                var_6 = var_6 + int( tablelookup( "cp/zombies/elements.csv", 1, var_9._id_9A09.chemical_contained, 19 ) );
                break;
        }

        var_7 = var_5 + var_6 - var_4;
    }

    if ( level.heat_pressure_machine_value == var_7 )
        setomnvar( "zm_chem_number_entry_1", -1 );
    else
    {
        scripts\engine\utility::_id_CE2B( "chemistry_reaction_failure", var_0.origin );
        var_1 thread play_failure_fx( var_1 );
        var_1 thread chem_failure_debuff( var_0, var_1 );
        level thread _id_0A6A::_id_12885( "ww_quest_failure", "rave_announcer_vo" );
        setomnvar( "zm_chem_number_entry_1", -1 );
        return;
    }

    wait 0.2;
    earthquake( 0.18, 3, var_0.origin, 784 );
    wait 0.05;
    playrumbleonentity( "artillery_rumble", var_0.origin );
    wait 2;
    var_11 = "";
    var_12 = "";
    var_13 = "";
    var_14 = "";
    var_15 = 0;
    var_16 = 0;
    var_17 = 0;
    var_18 = 0;

    foreach ( var_37, var_20 in level.compounds )
    {
        var_21 = var_37;
        var_15 = 0;
        var_16 = 0;
        var_17 = 0;
        var_18 = 0;
        var_11 = "";
        var_12 = "";
        var_13 = "";
        var_14 = "";

        if ( var_20.parta != "" )
            var_11 = var_20.parta;

        if ( var_20.partb != "" )
            var_12 = var_20.partb;

        if ( var_20.partc != "" )
            var_13 = var_20.partc;

        if ( var_20.partd != "" )
            var_14 = var_20.partd;

        if ( isdefined( var_11 ) && var_11 != "" )
        {
            foreach ( var_10, var_23 in level.chemical_containers )
            {
                if ( var_23._id_9A09.chemical_contained == "" )
                    continue;

                if ( var_11 == var_23._id_9A09.chemical_contained )
                {
                    var_15 = 1;
                    var_23._id_9A09.checked_in_reaction = 1;
                    continue;
                }
            }
        }
        else if ( isdefined( var_11 ) && var_11 == "" )
        {
            var_24 = 0;
            var_25 = 0;

            foreach ( var_10, var_23 in level.chemical_containers )
            {
                if ( scripts\engine\utility::_id_9CEE( var_23._id_9A09.checked_in_reaction ) )
                    continue;

                if ( var_23._id_9A09.chemical_contained == "" )
                {
                    if ( !var_24 )
                    {
                        var_15 = 1;
                        var_23._id_9A09.checked_in_reaction = 1;
                        var_24 = 1;
                        continue;
                    }
                }
                else
                {
                    var_15 = 0;
                    continue;
                }
            }
        }
        else
            var_15 = 0;

        if ( var_15 == 0 )
            continue;

        if ( isdefined( var_12 ) && var_12 != "" )
        {
            foreach ( var_10, var_23 in level.chemical_containers )
            {
                if ( var_23._id_9A09.chemical_contained == "" )
                    continue;

                if ( var_12 == var_23._id_9A09.chemical_contained )
                {
                    var_16 = 1;
                    var_23._id_9A09.checked_in_reaction = 1;
                    continue;
                }
            }
        }
        else if ( isdefined( var_12 ) && var_12 == "" )
        {
            var_28 = 0;
            var_29 = 0;

            foreach ( var_10, var_23 in level.chemical_containers )
            {
                if ( scripts\engine\utility::_id_9CEE( var_23._id_9A09.checked_in_reaction ) )
                    continue;

                if ( var_23._id_9A09.chemical_contained == "" )
                {
                    if ( !var_28 )
                    {
                        var_16 = 1;
                        var_23._id_9A09.checked_in_reaction = 1;
                        var_28 = 1;
                        continue;
                    }
                }
                else
                {
                    var_16 = 0;
                    continue;
                }
            }
        }
        else
            var_16 = 0;

        if ( var_16 == 0 )
            continue;

        if ( isdefined( var_13 ) && var_13 != "" )
        {
            foreach ( var_10, var_23 in level.chemical_containers )
            {
                if ( var_23._id_9A09.chemical_contained == "" )
                    continue;

                if ( var_13 == var_23._id_9A09.chemical_contained )
                {
                    var_17 = 1;
                    continue;
                }
            }
        }
        else if ( isdefined( var_13 ) && var_13 == "" )
        {
            var_32 = 0;
            var_33 = 0;

            foreach ( var_10, var_23 in level.chemical_containers )
            {
                if ( scripts\engine\utility::_id_9CEE( var_23._id_9A09.checked_in_reaction ) )
                    continue;

                if ( scripts\engine\utility::_id_9CEE( var_16 ) && scripts\engine\utility::_id_9CEE( var_15 ) )
                {
                    if ( var_23._id_9A09.chemical_contained == "" )
                    {
                        if ( !var_32 )
                        {
                            var_17 = 1;
                            var_23._id_9A09.checked_in_reaction = 1;
                            var_32 = 1;
                            continue;
                        }
                    }
                    else
                    {
                        var_17 = 0;
                        continue;
                    }
                }
                else
                {
                    var_17 = 0;
                    continue;
                }
            }
        }
        else
            var_17 = 0;

        if ( isdefined( var_14 ) && var_14 != "" )
        {
            foreach ( var_10, var_23 in level.chemical_containers )
            {
                if ( var_23._id_9A09.chemical_contained == "" )
                    continue;

                if ( var_14 == var_23._id_9A09.chemical_contained )
                {
                    var_18 = 1;
                    continue;
                }
            }
        }
        else if ( isdefined( var_14 ) && var_14 == "" )
        {
            if ( scripts\engine\utility::_id_9CEE( var_16 ) && scripts\engine\utility::_id_9CEE( var_15 ) && scripts\engine\utility::_id_9CEE( var_17 ) )
            {
                foreach ( var_10, var_23 in level.chemical_containers )
                {
                    if ( scripts\engine\utility::_id_9CEE( var_23._id_9A09.checked_in_reaction ) )
                        continue;

                    if ( var_23._id_9A09.chemical_contained == "" )
                    {
                        var_18 = 1;
                        break;
                    }
                    else
                    {
                        var_18 = 0;
                        continue;
                    }
                }
            }
            else
            {
                var_18 = 0;
                continue;
            }
        }
        else
            var_18 = 0;

        if ( var_15 && var_16 && var_17 && var_18 )
        {
            var_11 = "";
            var_12 = "";
            var_13 = "";
            var_14 = "";
            var_2 = var_21;
            level thread clear_check_status_beakers();
            break;
        }
        else
            continue;
    }

    if ( var_2 == "" )
    {
        var_1 thread play_failure_fx( var_1 );
        level thread clear_check_status_beakers();
        scripts\engine\utility::_id_CE2B( "chemistry_reaction_failure", var_0.origin );
        var_1 thread chem_failure_debuff( var_0, var_1 );
        level thread _id_0A6A::_id_12885( "ww_quest_failure", "rave_announcer_vo" );
        return;
    }

    level thread clear_check_status_beakers();
    level thread play_success_fx( var_1 );
    scripts\engine\utility::_id_CE2B( "chemistry_reaction_sucess", var_0.origin );

    for ( var_38 = level.chemical_compounds_created.size - 1; var_38 >= 0; var_38-- )
    {
        if ( isdefined( level.chemical_compounds_created[var_38 + 1] ) )
        {
            level.chemical_compounds_created[var_38 + 1]._id_9A09.compound_contained = level.chemical_compounds_created[var_38]._id_9A09.compound_contained;

            if ( level.chemical_compounds_created[var_38 + 1]._id_9A09.compound_contained != "" )
            {
                if ( isdefined( level.chemical_compounds_created[var_38 + 1]._id_9A09.filled_fx ) )
                    level.chemical_compounds_created[var_38 + 1]._id_9A09.filled_fx delete();

                foreach ( var_37, var_40 in level._id_601E )
                {
                    if ( var_37 == level.chemical_compounds_created[var_38 + 1]._id_9A09.compound_contained )
                    {
                        if ( isdefined( var_40.fx_trigger ) )
                        {
                            level.chemical_compounds_created[var_38 + 1]._id_9A09.filled_fx = spawnfx( var_40.fx_trigger, level.chemical_compounds_created[var_38 + 1]._id_9A09._id_01F1.origin );
                            triggerfx( level.chemical_compounds_created[var_38 + 1]._id_9A09.filled_fx );
                        }
                    }
                }

                continue;
            }

            if ( isdefined( level.chemical_compounds_created[var_38 + 1]._id_9A09.filled_fx ) )
                level.chemical_compounds_created[var_38 + 1]._id_9A09.filled_fx delete();
        }
    }

    level.chemical_compounds_created[0]._id_9A09.compound_contained = var_2;

    if ( isdefined( level.chemical_compounds_created[0]._id_9A09.filled_fx ) )
        level.chemical_compounds_created[0]._id_9A09.filled_fx delete();

    foreach ( var_37, var_42 in level._id_601E )
    {
        if ( var_37 == level.chemical_compounds_created[0]._id_9A09.compound_contained )
        {
            if ( isdefined( var_42.fx_trigger ) )
            {
                level.chemical_compounds_created[0]._id_9A09.filled_fx = spawnfx( var_42.fx_trigger, level.chemical_compounds_created[0]._id_9A09._id_01F1.origin );
                triggerfx( level.chemical_compounds_created[0]._id_9A09.filled_fx );
            }
        }
    }

    if ( level.chemical_compounds_created[0]._id_9A09.compound_contained != "" )
    {
        if ( isdefined( level.chemical_compounds_created[0]._id_9A09.filled_fx ) )
            triggerfx( level.chemical_compounds_created[0]._id_9A09.filled_fx );
        else
        {
            level.chemical_compounds_created[0]._id_9A09.filled_fx = spawnfx( level.chemical_compounds_created[0]._id_9A09.fx_trigger, level.chemical_compounds_created[0]._id_9A09._id_01F1.origin );
            triggerfx( level.chemical_compounds_created[0]._id_9A09.filled_fx );
        }
    }

    level thread update_beaker_omnvars();

    foreach ( var_44 in level.chemical_containers )
        discard_beaker_chemical( var_44._id_9A09, var_1 );
}

clear_check_status_beakers()
{
    foreach ( var_2, var_1 in level.chemical_containers )
        var_1._id_9A09.checked_in_reaction = 0;
}

update_beaker_omnvars()
{
    if ( level.chemical_compounds_created[0]._id_9A09.compound_contained != "" )
    {
        var_0 = level.chemical_compounds_created[0]._id_9A09.compound_contained;
        var_1 = int( level._id_601E[var_0]._id_C4A1 );
        setomnvar( "zm_chem_compound_slot_1_idx", var_1 );
    }
    else
        setomnvar( "zm_chem_compound_slot_1_idx", -1 );

    if ( level.chemical_compounds_created[1]._id_9A09.compound_contained != "" )
    {
        var_2 = level.chemical_compounds_created[1]._id_9A09.compound_contained;
        var_3 = int( level._id_601E[var_2]._id_C4A1 );
        setomnvar( "zm_chem_compound_slot_2_idx", var_3 );
    }
    else
        setomnvar( "zm_chem_compound_slot_2_idx", -1 );

    if ( level.chemical_compounds_created[2]._id_9A09.compound_contained != "" )
    {
        var_4 = level.chemical_compounds_created[2]._id_9A09.compound_contained;
        var_5 = int( level._id_601E[var_4]._id_C4A1 );
        setomnvar( "zm_chem_compound_slot_3_idx", var_5 );
    }
    else
        setomnvar( "zm_chem_compound_slot_3_idx", -1 );

    if ( level.chemical_compounds_created[3]._id_9A09.compound_contained != "" )
    {
        var_6 = level.chemical_compounds_created[3]._id_9A09.compound_contained;
        var_7 = int( level._id_601E[var_6]._id_C4A1 );
        setomnvar( "zm_chem_compound_slot_4_idx", var_7 );
    }
    else
        setomnvar( "zm_chem_compound_slot_4_idx", -1 );
}

chem_failure_debuff( var_0, var_1 )
{
    var_1 _meth_80B0( var_1.maxhealth * 0.95, var_1.origin );

    foreach ( var_3 in level.chemical_containers )
        discard_beaker_chemical( var_3._id_9A09, var_1 );
}

element_pickup_hint_func( var_0, var_1 )
{
    return "";
}

init_beakers()
{
    level._effect["sb_quest_item_pickup"] = loadfx( "vfx/iw7/core/zombie/vfx_zom_souvenir_pickup.vfx" );
    var_0 = scripts\engine\utility::_id_8180( "chemistry_container_model", "script_noteworthy" );

    foreach ( var_4, var_2 in var_0 )
    {
        var_3 = undefined;

        switch ( var_2.name )
        {
            case "chem_container_01":
                var_3 = spawn( "script_model", var_2.origin );
                var_3 setmodel( "tag_origin" );
                var_3.angles = var_2.angles;
                break;
            case "chem_container_02":
                var_3 = spawn( "script_model", var_2.origin );
                var_3 setmodel( "tag_origin" );
                var_3.angles = var_2.angles;
                break;
            case "chem_container_03":
                var_3 = spawn( "script_model", var_2.origin );
                var_3 setmodel( "tag_origin" );
                var_3.angles = var_2.angles;
                break;
            case "chem_container_04":
                var_3 = spawn( "script_model", var_2.origin );
                var_3 setmodel( "tag_origin" );
                var_3.angles = var_2.angles;
                break;
            default:
        }

        var_3 hide();
        var_2.chemical_contained = "";

        if ( isdefined( var_3 ) )
            var_2._id_01F1 = var_3;

        level.chemical_containers[var_4] = var_2;
    }
}

init_compound_storage_objects()
{
    var_0 = scripts\engine\utility::_id_8180( "compound_storage_model", "script_noteworthy" );

    foreach ( var_4, var_2 in var_0 )
    {
        var_3 = undefined;

        switch ( var_2.name )
        {
            case "compound_storage_1":
                var_3 = spawn( "script_model", var_2.origin );
                var_3 setmodel( "p7_chemistry_kit_beaker_lg" );
                var_3.angles = var_2.angles;
                break;
            case "compound_storage_2":
                var_3 = spawn( "script_model", var_2.origin );
                var_3 setmodel( "p7_chemistry_kit_beaker_lg" );
                var_3.angles = var_2.angles;
                break;
            case "compound_storage_3":
                var_3 = spawn( "script_model", var_2.origin );
                var_3 setmodel( "p7_chemistry_kit_beaker_lg" );
                var_3.angles = var_2.angles;
                break;
            case "compound_storage_4":
                var_3 = spawn( "script_model", var_2.origin );
                var_3 setmodel( "p7_chemistry_kit_beaker_lg" );
                var_3.angles = var_2.angles;
                break;
            default:
        }

        var_3 hide();

        if ( isdefined( var_3 ) )
            var_2._id_01F1 = var_3;

        var_2.compound_contained = "";
        var_2.compound_container_filled = 0;
        level.chemical_compounds_created[var_4] = var_2;
    }
}

watch_for_input_entered_on_compound( var_0 )
{
    self notifyonplayercommand( "add_compound", "+usereload" );
    self notifyonplayercommand( "add_compound", "+activate" );
    self notifyonplayercommand( "discard_compound", "+actionslot 4" );
    var_1 = "";

    for (;;)
    {
        var_1 = scripts\engine\utility::_id_13734( "add_compound", "discard_compound" );

        if ( distance2dsquared( var_0.origin, self.origin ) > 8100 )
        {
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( !self _meth_8409( var_0.origin, 65, 90 ) )
        {
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( !isdefined( var_1 ) )
        {
            scripts\engine\utility::waitframe();
            continue;
        }

        if ( var_1 == "add_compound" )
        {
            add_compound_to_player( var_0, self );
            wait 1;
            continue;
        }

        if ( var_1 == "discard_compound" )
        {
            discard_compound( var_0, self );
            wait 1;
        }
    }
}

get_compound_object_value( var_0 )
{
    return var_0.compound_contained;
}

discard_compound( var_0, var_1 )
{
    if ( isdefined( var_0.compound_contained ) && var_0.compound_contained != "" )
    {
        var_0.compound_contained = "";
        level thread update_beaker_omnvars();

        if ( isdefined( var_0.filled_fx ) )
            var_0.filled_fx delete();

        playloopsound( var_0.origin, "chemistry_placement" );
    }
    else
    {

    }
}

add_compound_to_player( var_0, var_1 )
{
    var_2 = get_compound_object_value( var_0 );
    var_3 = get_chemical_carried_by_player( var_1 );
    playloopsound( var_0._id_01F1.origin, "chemistry_placement" );

    if ( var_2 == "" )
    {
        if ( var_3 != "" )
        {
            set_chemical_carried_by_player_after_beaker_deposit( var_1, "" );
            level thread update_beaker_omnvars();
            playfx( level._effect["sb_quest_item_pickup"], var_0.origin );
            return;
        }

        return;
    }

    set_chemical_carried_by_player( var_1, var_2 );

    if ( var_2 == level.bomb_compound.name )
    {
        scripts\engine\utility::_id_6E3E( "chemistry_step3" );
        var_1 thread _id_0A6A::_id_12885( "key_phase_2_collect_mixture", "town_comment_vo" );
    }

    playfx( level._effect["sb_quest_item_pickup"], var_0.origin );
}

discard_beaker_chemical( var_0, var_1 )
{
    if ( isdefined( var_0.chemical_contained ) && var_0.chemical_contained != "" )
    {
        if ( isdefined( var_0.filled_fx ) )
            var_0.filled_fx delete();

        var_0.chemical_contained = "";
        var_0._id_01F1 setmodel( "tag_origin" );
    }
    else
    {

    }

    display_elements_in_beakers( var_0, -1, var_1 );
}

get_chemistry_object_value( var_0, var_1 )
{
    if ( scripts\engine\utility::_id_9CEE( var_1 ) )
        return var_0.chemical_contained;
    else
        return var_0.chemical_object_name;
}

add_element_to_beaker_interaction( var_0, var_1 )
{
    var_2 = var_0.chemical_contained;

    if ( !isdefined( var_1.chemical_base_picked ) )
        var_1.chemical_base_picked = "";

    var_3 = var_1.chemical_base_picked;

    if ( var_3 == "" )
    {
        if ( var_2 == "" )
        {
            var_1 playlocalsound( "perk_machine_deny" );
            return;
        }
        else
        {
            set_chemical_carried_by_player( var_1, var_2 );
            discard_beaker_chemical( var_0, var_1 );
            playloopsound( var_0._id_01F1.origin, "chemistry_placement" );
        }

        return;
    }
    else
    {
        playloopsound( var_0._id_01F1.origin, "chemistry_placement" );

        if ( var_2 == "" )
        {
            foreach ( var_6, var_5 in level._id_601E )
            {
                if ( var_3 == var_6 )
                {
                    if ( var_5.type == "componant" || var_5.type == "final" )
                    {
                        if ( isdefined( var_5.fx_trigger ) )
                        {
                            var_0.filled_fx = spawnfx( var_5.fx_trigger, var_0._id_01F1.origin );
                            triggerfx( var_0.filled_fx );
                        }
                    }

                    var_0._id_01F1 setmodel( var_5._id_01F1 );
                }
            }
        }
        else
        {
            playloopsound( var_0._id_01F1.origin, "chemistry_placement" );

            foreach ( var_6, var_8 in level._id_601E )
            {
                if ( var_3 == var_6 )
                {
                    var_0._id_01F1 setmodel( var_8._id_01F1 );

                    if ( var_8.type == "componant" || var_8.type == "final" )
                    {
                        if ( isdefined( var_0.filled_fx ) )
                            var_0.filled_fx delete();

                        if ( isdefined( var_8.fx_trigger ) )
                        {
                            var_0.filled_fx = spawnfx( var_8.fx_trigger, var_0._id_01F1.origin );
                            triggerfx( var_0.filled_fx );
                        }

                        continue;
                    }

                    if ( isdefined( var_0.filled_fx ) )
                        var_0.filled_fx delete();
                }
            }
        }
    }

    var_9 = var_2;
    playfx( level._effect["sb_quest_item_pickup"], var_0.origin );
    add_chemical_to_beaker( var_1, var_0 );
    set_chemical_carried_by_player_after_beaker_deposit( var_1, var_9 );
    display_elements_in_beakers( var_0, var_3, var_1 );
}

add_compounds_interaction( var_0, var_1 )
{
    var_2 = get_compound_object_value( var_0 );
    var_3 = get_chemical_carried_by_player( var_1 );
    playloopsound( var_0._id_01F1.origin, "chemistry_placement" );

    if ( var_2 == "" )
    {
        if ( var_3 != "" )
        {
            set_chemical_carried_by_player_after_beaker_deposit( var_1, "" );
            level thread update_beaker_omnvars();
            playfx( level._effect["sb_quest_item_pickup"], var_0.origin );
            return;
        }

        return;
    }

    set_chemical_carried_by_player( var_1, var_2 );

    if ( var_2 == level.bomb_compound.name )
    {
        scripts\engine\utility::_id_6E3E( "chemistry_step3" );
        var_1 thread _id_0A6A::_id_12885( "key_phase_2_collect_mixture", "town_comment_vo" );
    }

    playfx( level._effect["sb_quest_item_pickup"], var_0.origin );
}

try_play_swap_vfx( var_0, var_1, var_2 )
{
    var_3 = get_chemistry_object_value( var_0, var_2 );
    var_4 = get_chemical_carried_by_player( var_1 );

    if ( var_4 == "" && !scripts\engine\utility::_id_9CEE( var_2 ) )
    {
        playfx( level._effect["sb_quest_item_pickup"], var_0.chemical_model_object.origin );
        set_chemical_carried_by_player( var_1, var_3 );
    }
    else if ( var_4 == "" && scripts\engine\utility::_id_9CEE( var_2 ) )
    {
        if ( var_3 == "" )
        {
            var_1 playlocalsound( "perk_machine_deny" );
            return;
        }
        else
        {
            set_chemical_carried_by_player( var_1, var_3 );
            discard_beaker_chemical( var_0, var_1 );
            playloopsound( var_0._id_01F1.origin, "chemistry_placement" );
        }

        return;
    }
    else if ( scripts\engine\utility::_id_9CEE( var_2 ) )
    {
        playloopsound( var_0._id_01F1.origin, "chemistry_placement" );

        if ( var_3 == "" )
        {
            foreach ( var_7, var_6 in level._id_601E )
            {
                if ( var_4 == var_7 )
                {
                    if ( var_6.type == "componant" || var_6.type == "final" )
                    {
                        if ( isdefined( var_6.fx_trigger ) )
                        {
                            var_0.filled_fx = spawnfx( var_6.fx_trigger, var_0._id_01F1.origin );
                            triggerfx( var_0.filled_fx );
                        }
                    }

                    var_0._id_01F1 setmodel( var_6._id_01F1 );
                }
            }
        }
        else
        {
            playloopsound( var_0._id_01F1.origin, "chemistry_placement" );

            foreach ( var_7, var_9 in level._id_601E )
            {
                if ( var_4 == var_7 )
                {
                    var_0._id_01F1 setmodel( var_9._id_01F1 );

                    if ( var_9.type == "componant" || var_9.type == "final" )
                    {
                        if ( isdefined( var_0.filled_fx ) )
                            var_0.filled_fx delete();

                        if ( isdefined( var_9.fx_trigger ) )
                        {
                            var_0.filled_fx = spawnfx( var_9.fx_trigger, var_0._id_01F1.origin );
                            triggerfx( var_0.filled_fx );
                        }

                        continue;
                    }

                    foreach ( var_11 in level.chemical_containers )
                    {
                        foreach ( var_14, var_13 in level._id_601E )
                        {
                            if ( var_4 == var_14 )
                            {
                                if ( var_13.type != "componant" || var_13.type != "final" )
                                {
                                    if ( isdefined( var_11.filled_fx ) )
                                        var_11.filled_fx delete();
                                }
                            }
                        }
                    }
                }
            }
        }

        var_16 = var_3;
        playfx( level._effect["sb_quest_item_pickup"], var_0.origin );
        add_chemical_to_beaker( var_1, var_0 );
        set_chemical_carried_by_player_after_beaker_deposit( var_1, var_16 );
        display_elements_in_beakers( var_0, var_4, var_1 );
    }
    else
    {
        set_chemical_carried_by_player( var_1, var_3 );
        playfx( level._effect["sb_quest_item_pickup"], var_0.chemical_model_object.origin );
    }
}

add_chemical_to_beaker( var_0, var_1 )
{
    var_2 = get_chemistry_object_value( var_1, 1 );
    var_3 = get_chemical_carried_by_player( var_0 );

    if ( var_2 != "" )
    {

    }

    set_chemical_in_beaker( var_1, var_3, var_0 );
    display_elements_in_beakers( var_1, var_3, var_0 );
}

display_elements_in_beakers( var_0, var_1, var_2 )
{
    var_3 = tablelookup( "cp/zombies/elements.csv", 1, var_1, 0 );
    var_4 = "chem_container_01";

    switch ( var_0.name )
    {
        case "chem_container_01":
            var_4 = "zm_lab_screen_beaker1";
            break;
        case "chem_container_02":
            var_4 = "zm_lab_screen_beaker2";
            break;
        case "chem_container_03":
            var_4 = "zm_lab_screen_beaker3";
            break;
        case "chem_container_04":
            var_4 = "zm_lab_screen_beaker4";
            break;
    }

    if ( isdefined( var_3 ) )
        setomnvar( var_4, int( var_3 ) );
}

set_chemical_in_beaker( var_0, var_1, var_2 )
{
    if ( !isdefined( var_0.chemical_contained ) )
    {
        var_2 playlocalsound( "perk_machine_deny" );
        return;
    }

    var_3 = var_0.chemical_contained;
    var_0.chemical_contained = var_1;
}

swap_chemistry_object_with_player_chemical( var_0, var_1, var_2 )
{
    var_3 = get_chemistry_object_value( var_0 );
    var_4 = get_chemical_carried_by_player( var_1 );
    set_chemical_carried_by_player( var_1, var_3 );
}

get_chemical_carried_by_player( var_0 )
{
    if ( !isdefined( var_0.chemical_base_picked ) )
        var_0.chemical_base_picked = "";

    return var_0.chemical_base_picked;
}

set_chemical_carried_by_player( var_0, var_1 )
{
    var_0.chemical_base_picked = var_1;
    var_2 = int( level._id_601E[var_1]._id_C4A1 );
    var_0 setclientomnvar( "zm_chem_element_index", var_2 );
    var_0 playlocalsound( "zmb_item_pickup" );
}

set_chemical_carried_by_player_after_beaker_deposit( var_0, var_1 )
{
    var_2 = int( level._id_601E[var_0.chemical_base_picked]._id_C4A1 );
    var_0 setclientomnvar( "zm_chem_element_index", var_2 );
    var_0.chemical_base_picked = var_1;

    if ( isdefined( level._id_601E[var_0.chemical_base_picked] ) )
    {
        var_3 = int( level._id_601E[var_0.chemical_base_picked]._id_C4A1 );
        var_0 setclientomnvar( "zm_chem_element_index", var_3 );
    }
    else
        var_0 setclientomnvar( "zm_chem_element_index", 0 );
}

init_setup_radio_prefabs()
{
    scripts\cp\maps\cp_town\cp_town_interactions::town_register_interaction( 1, "chem_radio_interaction", undefined, undefined, ::radios_interaction_hint_func, ::radios_activation_function, 0, 0, ::init_chem_radios, undefined );
}

radios_interaction_hint_func( var_0, var_1 )
{
    return "";
}

init_chem_radios()
{
    level.chem_radio_1_sounds = [];
    level.chem_radio_1_sounds[0] = "db_day_2";
    level.chem_radio_2_sounds = [];
    level.chem_radio_2_sounds[0] = "db_day_3";
    level.chem_radio_3_sounds = [];
    level.chem_radio_3_sounds[0] = "db_day_5";
    level.chem_radio_4_sounds = [];
    level.chem_radio_4_sounds[0] = "db_day_6";
    level.chem_radio_5_sounds = [];
    level.chem_radio_5_sounds[0] = "db_day_7";
    level.chem_radio_6_sounds = [];
    level.chem_radio_6_sounds[0] = "db_day_8";
    var_0 = scripts\engine\utility::_id_8180( "chem_radio_interaction", "script_noteworthy" );

    foreach ( var_4, var_2 in var_0 )
    {
        var_2.radio = spawn( "script_origin", var_2.origin );
        var_3 = undefined;

        if ( isdefined( var_3 ) )
            var_2._id_01F1 = var_3;
    }

    setup_radio_vo_from_elements();
}

radios_activation_function( var_0, var_1 )
{
    var_2 = var_0.radio;
    var_3 = undefined;
    _id_0A59::_id_E019( var_0 );

    switch ( var_0.name )
    {
        case "chem_radio_1":
            if ( isdefined( level.chem_radio_1_wave ) )
            {
                if ( level.chem_radio_1_wave >= level._id_13BD3 )
                {
                    var_1 _id_0A77::_id_F78C( "rewinding_tape", &"CP_TOWN_TAPE_REWINDING", 3 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
            }

            if ( !isdefined( level.element_intro_played ) )
            {
                level.chem_radio_1_sounds = _id_0A77::_id_22B0( level.chem_radio_1_sounds, 0, 0 );
                level.chem_radio_1_sounds = scripts\engine\utility::_id_229C( level.chem_radio_1_sounds, "db_intro_1", 0 );
                level.element_intro_played = 1;
            }

            if ( !isdefined( level.chem_radio_1_current ) )
                level.chem_radio_1_current = 0;

            var_3 = level.chem_radio_1_sounds[level.chem_radio_1_current];
            var_2 playsound( var_3 );
            level.chem_radio_1_current = level.chem_radio_1_current + 1;

            if ( level.chem_radio_1_current == level.chem_radio_1_sounds.size )
            {
                level.chem_radio_1_current = 0;
                level.chem_radio_1_wave = level._id_13BD3;
            }

            break;
        case "chem_radio_2":
            if ( isdefined( level.chem_radio_2_wave ) )
            {
                if ( level.chem_radio_2_wave >= level._id_13BD3 )
                {
                    var_1 _id_0A77::_id_F78C( "rewinding_tape", &"CP_TOWN_TAPE_REWINDING", 3 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
            }

            if ( !isdefined( level.element_intro_played ) )
            {
                level.chem_radio_2_sounds = _id_0A77::_id_22B0( level.chem_radio_2_sounds, 0, 0 );
                level.chem_radio_2_sounds = scripts\engine\utility::_id_229C( level.chem_radio_2_sounds, "db_intro_1", 0 );
                level.element_intro_played = 1;
            }

            if ( !isdefined( level.chem_radio_2_current ) )
                level.chem_radio_2_current = 0;

            var_3 = level.chem_radio_2_sounds[level.chem_radio_2_current];
            var_2 playsound( var_3 );
            level.chem_radio_2_current = level.chem_radio_2_current + 1;

            if ( level.chem_radio_2_current == level.chem_radio_2_sounds.size )
            {
                level.chem_radio_2_wave = level._id_13BD3;
                level.chem_radio_2_current = 0;
            }

            break;
        case "chem_radio_3":
            if ( isdefined( level.chem_radio_3_wave ) )
            {
                if ( level.chem_radio_3_wave >= level._id_13BD3 )
                {
                    var_1 _id_0A77::_id_F78C( "rewinding_tape", &"CP_TOWN_TAPE_REWINDING", 3 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
            }

            if ( !isdefined( level.element_intro_played ) )
            {
                level.chem_radio_3_sounds = _id_0A77::_id_22B0( level.chem_radio_3_sounds, 0, 0 );
                level.chem_radio_3_sounds = scripts\engine\utility::_id_229C( level.chem_radio_3_sounds, "db_intro_1", 0 );
                level.element_intro_played = 1;
            }

            if ( !isdefined( level.chem_radio_3_current ) )
                level.chem_radio_3_current = 0;

            var_3 = level.chem_radio_3_sounds[level.chem_radio_3_current];
            var_2 playsound( var_3 );
            level.chem_radio_3_current = level.chem_radio_3_current + 1;

            if ( level.chem_radio_3_current == level.chem_radio_3_sounds.size )
            {
                level.chem_radio_3_wave = level._id_13BD3;
                level.chem_radio_3_current = 0;
            }

            break;
        case "chem_radio_4":
            if ( isdefined( level.chem_radio_4_wave ) )
            {
                if ( level.chem_radio_4_wave >= level._id_13BD3 )
                {
                    var_1 _id_0A77::_id_F78C( "rewinding_tape", &"CP_TOWN_TAPE_REWINDING", 3 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
            }

            if ( !isdefined( level.element_intro_played ) )
            {
                level.chem_radio_4_sounds = _id_0A77::_id_22B0( level.chem_radio_4_sounds, 0, 0 );
                level.chem_radio_4_sounds = scripts\engine\utility::_id_229C( level.chem_radio_4_sounds, "db_intro_1", 0 );
                level.element_intro_played = 1;
            }

            if ( !isdefined( level.chem_radio_4_current ) )
                level.chem_radio_4_current = 0;

            var_3 = level.chem_radio_4_sounds[level.chem_radio_4_current];
            var_2 playsound( var_3 );
            level.chem_radio_4_current = level.chem_radio_4_current + 1;

            if ( level.chem_radio_4_current == level.chem_radio_4_sounds.size )
            {
                level.chem_radio_4_wave = level._id_13BD3;
                level.chem_radio_4_current = 0;
            }

            break;
        case "chem_radio_5":
            if ( isdefined( level.chem_radio_5_wave ) )
            {
                if ( level.chem_radio_5_wave >= level._id_13BD3 )
                {
                    var_1 _id_0A77::_id_F78C( "rewinding_tape", &"CP_TOWN_TAPE_REWINDING", 3 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
            }

            if ( !isdefined( level.compound_intro_played ) )
            {
                level.chem_radio_5_sounds = _id_0A77::_id_22B0( level.chem_radio_5_sounds, 0, 0 );
                level.chem_radio_5_sounds = scripts\engine\utility::_id_229C( level.chem_radio_5_sounds, "db_intro_3", 0 );
                level.compound_intro_played = 1;
            }

            if ( !isdefined( level.chem_radio_5_current ) )
                level.chem_radio_5_current = 0;

            var_3 = level.chem_radio_5_sounds[level.chem_radio_5_current];
            var_2 playsound( var_3 );
            level.chem_radio_5_current = level.chem_radio_5_current + 1;

            if ( level.chem_radio_5_current == level.chem_radio_5_sounds.size )
            {
                level.chem_radio_5_wave = level._id_13BD3;
                level.chem_radio_5_current = 0;
            }

            break;
        case "chem_radio_6":
            if ( isdefined( level.chem_radio_6_wave ) )
            {
                if ( level.chem_radio_6_wave >= level._id_13BD3 )
                {
                    var_1 _id_0A77::_id_F78C( "rewinding_tape", &"CP_TOWN_TAPE_REWINDING", 3 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
            }

            if ( !isdefined( level.compound_intro_played ) )
            {
                level.chem_radio_6_sounds = _id_0A77::_id_22B0( level.chem_radio_6_sounds, 0, 0 );
                level.chem_radio_6_sounds = scripts\engine\utility::_id_229C( level.chem_radio_6_sounds, "db_intro_3", 0 );
                level.compound_intro_played = 1;
            }

            if ( !isdefined( level.chem_radio_6_current ) )
                level.chem_radio_6_current = 0;

            var_3 = level.chem_radio_6_sounds[level.chem_radio_6_current];
            var_2 playsound( var_3 );
            level.chem_radio_6_current = level.chem_radio_6_current + 1;

            if ( level.chem_radio_6_current == level.chem_radio_6_sounds.size )
            {
                level.chem_radio_6_wave = level._id_13BD3;
                level.chem_radio_6_current = 0;
            }

            break;
        case "chem_radio_7":
            if ( isdefined( level.chem_radio_7_wave ) )
            {
                if ( level.chem_radio_7_wave >= level._id_13BD3 )
                {
                    var_1 _id_0A77::_id_F78C( "rewinding_tape", &"CP_TOWN_TAPE_REWINDING", 3 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
            }

            if ( !scripts\engine\utility::_id_9CEE( level.chem_radio_7_fixed ) )
            {
                if ( !scripts\engine\utility::_id_9CEE( var_1.has_battery ) )
                {
                    var_1 _id_0A77::_id_F78C( "needs_battery", &"CP_TOWN_NEED_BATTERY", 4 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
                else
                {
                    var_1 _id_0A77::_id_F78C( "insert_battery", &"CP_TOWN_INSERT_BATTERY", 4 );
                    level.chem_radio_7_fixed = 1;
                    var_1.has_battery = 0;
                    level.chem_radios_fixed = level.chem_radios_fixed + 1;
                    level notify( "radio_fixed" );
                    var_1 setclientomnvar( "zm_nag_text", 0 );
                }
            }

            if ( !isdefined( level.chem_radio_7_current ) )
                level.chem_radio_7_current = 0;

            if ( scripts\engine\utility::_id_9CEE( level.radio_flip ) )
            {
                var_3 = level.bomb_compound.radio2[level.chem_radio_7_current]._id_10475;
                var_2 playsound( var_3 );
                level.chem_radio_7_current = level.chem_radio_7_current + 1;

                if ( level.chem_radio_7_current == level.bomb_compound.radio2.size )
                {
                    level.chem_radio_7_wave = level._id_13BD3;
                    level.chem_radio_7_current = 0;
                }
            }
            else
            {
                var_3 = level.bomb_compound.radio1[level.chem_radio_7_current]._id_10475;
                var_2 playsound( var_3 );
                level.chem_radio_7_current = level.chem_radio_7_current + 1;

                if ( level.chem_radio_7_current == level.bomb_compound.radio1.size )
                {
                    level.chem_radio_7_wave = level._id_13BD3;
                    level.chem_radio_7_current = 0;
                }
            }

            var_1 _meth_80F3( &"CP_TOWN_INSERT_BATTERY" );
            break;
        case "chem_radio_8":
            if ( isdefined( level.chem_radio_8_wave ) )
            {
                if ( level.chem_radio_8_wave >= level._id_13BD3 )
                {
                    var_1 _id_0A77::_id_F78C( "rewinding_tape", &"CP_TOWN_TAPE_REWINDING", 3 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
            }

            if ( !scripts\engine\utility::_id_9CEE( level.chem_radio_8_fixed ) )
            {
                if ( !scripts\engine\utility::_id_9CEE( var_1.has_battery ) )
                {
                    var_1 _id_0A77::_id_F78C( "needs_battery", &"CP_TOWN_NEED_BATTERY", 4 );
                    _id_0A59::_id_175C( var_0 );
                    return;
                }
                else
                {
                    var_1 _id_0A77::_id_F78C( "insert_battery", &"CP_TOWN_INSERT_BATTERY", 4 );
                    level.chem_radio_8_fixed = 1;
                    var_1.has_battery = 0;
                    level.chem_radios_fixed = level.chem_radios_fixed + 1;
                    level notify( "radio_fixed" );
                    var_1 setclientomnvar( "zm_nag_text", 0 );
                }
            }

            if ( !isdefined( level.chem_radio_8_current ) )
                level.chem_radio_8_current = 0;

            if ( scripts\engine\utility::_id_9CEE( level.radio_flip ) )
            {
                var_3 = level.bomb_compound.radio1[level.chem_radio_8_current]._id_10475;
                var_2 playsound( var_3 );
                level.chem_radio_8_current = level.chem_radio_8_current + 1;

                if ( level.chem_radio_8_current == level.bomb_compound.radio1.size )
                {
                    level.chem_radio_8_wave = level._id_13BD3;
                    level.chem_radio_8_current = 0;
                }
            }
            else
            {
                var_3 = level.bomb_compound.radio2[level.chem_radio_8_current]._id_10475;
                var_2 playsound( var_3 );
                level.chem_radio_8_current = level.chem_radio_8_current + 1;

                if ( level.chem_radio_8_current == level.bomb_compound.radio2.size )
                {
                    level.chem_radio_8_wave = level._id_13BD3;
                    level.chem_radio_8_current = 0;
                }
            }

            break;
    }

    var_4 = lookupsoundlength( var_3 ) / 1000;
    wait( var_4 );

    if ( var_3 == "db_hmx_4_clue" )
    {
        var_2 playsound( "db_hmx_4_append_clue" );
        var_4 = lookupsoundlength( "db_hmx_4_append_clue" ) / 1000;
        wait( var_4 );
    }

    _id_0A59::_id_175C( var_0 );
}

setup_final_compound()
{
    level.bomb_compound = spawnstruct();
    level.bomb_name_array = [];
    var_0 = randomintrange( 0, level.final_compounds.size - 1 );
    determine_proper_color();
    level.bomb_compound.name = level.final_compounds[var_0];

    if ( !isdefined( level.bomb_compound.name ) )
    {

    }

    select_heat_pressure_choice_values();
    select_constant_value();
}

determine_proper_color()
{
    var_0 = randomintrange( 1, 4 );

    if ( var_0 == 1 )
        level.bomb_compound._id_00B9 = "red";
    else if ( var_0 == 2 )
        level.bomb_compound._id_00B9 = "green";
    else
        level.bomb_compound._id_00B9 = "blue";

    setomnvar( "zm_chem_correct_color", var_0 );
}

select_heat_pressure_choice_values()
{
    var_0 = randomintrange( 1, 7 );
    level.bomb_compound.choice = var_0;
    level.bad_choice_index_default = randomintrange( 1, 7 );

    for (;;)
    {
        if ( level.bad_choice_index_default == level.bomb_compound.choice )
        {
            level.bad_choice_index_default = randomintrange( 1, 7 );
            continue;
        }

        break;
    }

    level.bad_choice_index_color_red = randomintrange( 1, 7 );

    for (;;)
    {
        if ( level.bad_choice_index_color_red == level.bomb_compound.choice || level.bad_choice_index_color_red == level.bad_choice_index_default )
        {
            level.bad_choice_index_color_red = randomintrange( 1, 7 );
            continue;
        }

        break;
    }

    level.bad_choice_index_color_green = randomintrange( 1, 7 );

    for (;;)
    {
        if ( level.bad_choice_index_color_green == level.bomb_compound.choice || level.bad_choice_index_color_green == level.bad_choice_index_default || level.bad_choice_index_color_green == level.bad_choice_index_color_red )
        {
            level.bad_choice_index_color_green = randomintrange( 1, 7 );
            continue;
        }

        break;
    }

    level.bad_choice_index_color_blue = randomintrange( 1, 7 );

    for (;;)
    {
        if ( level.bad_choice_index_color_blue == level.bomb_compound.choice || level.bad_choice_index_color_blue == level.bad_choice_index_default || level.bad_choice_index_color_blue == level.bad_choice_index_color_red || level.bad_choice_index_color_blue == level.bad_choice_index_color_green )
        {
            level.bad_choice_index_color_blue = randomintrange( 1, 7 );
            continue;
        }

        break;
    }

    thread set_blackboard_initial_omnvar();
}

set_blackboard_initial_omnvar()
{
    wait 5;
    setomnvar( "zm_chem_bvalue_choice", level.bad_choice_index_default );
}

select_constant_value()
{
    var_0 = [];
    var_1 = 0;

    for (;;)
    {
        var_2 = tablelookupbyrow( "cp/zombies/diapi_table.csv", var_1, 1 );

        if ( var_2 == "" )
            break;

        var_0[var_1] = int( var_2 );
        var_1++;
    }

    var_3 = randomintrange( 0, var_0.size );
    level.constant_value = var_0[var_3];
    var_4 = randomintrange( 0, var_0.size );

    for (;;)
    {
        if ( var_4 == var_3 )
        {
            var_4 = randomintrange( 0, var_0.size );
            continue;
        }

        break;
    }

    var_5 = randomintrange( 0, var_0.size );

    for (;;)
    {
        if ( var_5 == var_3 || var_5 == var_4 )
        {
            var_5 = randomintrange( 0, var_0.size );
            continue;
        }

        break;
    }

    var_6 = randomintrange( 0, var_0.size );

    for (;;)
    {
        if ( var_6 == var_3 || var_6 == var_4 || var_6 == var_5 )
        {
            var_6 = randomintrange( 0, var_0.size );
            continue;
        }

        break;
    }

    level.constant_bad_value_1 = var_0[var_4];
    level.constant_bad_value_2 = var_0[var_5];
    level.constant_bad_value_3 = var_0[var_6];
    choose_constant_locations();
}

choose_constant_locations()
{
    level.correct_constant_loc = randomintrange( 1, 5 );
    var_0 = randomintrange( 1, 5 );

    for (;;)
    {
        if ( var_0 == level.correct_constant_loc )
        {
            var_0 = randomintrange( 1, 4 );
            continue;
        }

        break;
    }

    var_1 = randomintrange( 1, 5 );

    for (;;)
    {
        if ( var_1 == level.correct_constant_loc || var_1 == var_0 )
        {
            var_1 = randomintrange( 1, 5 );
            continue;
        }

        break;
    }

    var_2 = randomintrange( 1, 5 );

    for (;;)
    {
        if ( var_2 == level.correct_constant_loc || var_2 == var_0 || var_2 == var_1 )
        {
            var_2 = randomintrange( 1, 5 );
            continue;
        }

        break;
    }

    level.bad_constants_loc1 = spawnstruct();
    level.bad_constants_loc1._id_13153 = var_0;
    level.bad_constants_loc2 = spawnstruct();
    level.bad_constants_loc2._id_13153 = var_1;
    level.bad_constants_loc3 = spawnstruct();
    level.bad_constants_loc3._id_13153 = var_2;
    set_constant_omnvars( level.correct_constant_loc, level.constant_value );
    set_constant_omnvars( var_0, level.constant_bad_value_1 );
    set_constant_omnvars( var_1, level.constant_bad_value_2 );
    set_constant_omnvars( var_2, level.constant_bad_value_3 );
    set_bad_loc_colors();

    if ( level.bad_constants_loc1._id_13153 == 1 )
        level.bad_constants_loc1._id_C4A1 = "zm_chem_const_bad_loc_1";
    else if ( level.bad_constants_loc1._id_13153 == 2 )
        level.bad_constants_loc1._id_C4A1 = "zm_chem_const_bad_loc_2";
    else if ( level.bad_constants_loc1._id_13153 == 3 )
        level.bad_constants_loc1._id_C4A1 = "zm_chem_const_bad_loc_3";
    else if ( level.bad_constants_loc1._id_13153 == 4 )
        level.bad_constants_loc1._id_C4A1 = "zm_chem_const_bad_loc_4";

    if ( level.bad_constants_loc2._id_13153 == 1 )
        level.bad_constants_loc2._id_C4A1 = "zm_chem_const_bad_loc_1";
    else if ( level.bad_constants_loc2._id_13153 == 2 )
        level.bad_constants_loc2._id_C4A1 = "zm_chem_const_bad_loc_2";
    else if ( level.bad_constants_loc2._id_13153 == 3 )
        level.bad_constants_loc2._id_C4A1 = "zm_chem_const_bad_loc_3";
    else if ( level.bad_constants_loc2._id_13153 == 4 )
        level.bad_constants_loc2._id_C4A1 = "zm_chem_const_bad_loc_4";

    if ( level.bad_constants_loc3._id_13153 == 1 )
        level.bad_constants_loc3._id_C4A1 = "zm_chem_const_bad_loc_1";
    else if ( level.bad_constants_loc3._id_13153 == 2 )
        level.bad_constants_loc3._id_C4A1 = "zm_chem_const_bad_loc_2";
    else if ( level.bad_constants_loc3._id_13153 == 3 )
        level.bad_constants_loc3._id_C4A1 = "zm_chem_const_bad_loc_3";
    else if ( level.bad_constants_loc3._id_13153 == 4 )
        level.bad_constants_loc3._id_C4A1 = "zm_chem_const_bad_loc_4";

    select_pi_value();
}

set_constant_omnvars( var_0, var_1 )
{
    switch ( var_0 )
    {
        case 1:
            setomnvar( "zm_chem_const_loc_1", var_1 );
            break;
        case 2:
            setomnvar( "zm_chem_const_loc_2", var_1 );
            break;
        case 3:
            setomnvar( "zm_chem_const_loc_3", var_1 );
            break;
        case 4:
            setomnvar( "zm_chem_const_loc_4", var_1 );
            break;
    }
}

set_bad_loc_colors()
{
    var_0 = randomintrange( 1, 4 );

    if ( var_0 == 1 )
        level.bad_constants_loc1._id_00B9 = "red";
    else if ( var_0 == 2 )
        level.bad_constants_loc1._id_00B9 = "green";
    else
        level.bad_constants_loc1._id_00B9 = "blue";

    var_1 = randomintrange( 1, 4 );

    for (;;)
    {
        if ( var_1 == var_0 )
        {
            var_1 = randomintrange( 1, 4 );
            continue;
        }

        break;
    }

    if ( var_1 == 1 )
        level.bad_constants_loc2._id_00B9 = "red";
    else if ( var_1 == 2 )
        level.bad_constants_loc2._id_00B9 = "green";
    else
        level.bad_constants_loc2._id_00B9 = "blue";

    var_2 = randomintrange( 1, 4 );

    for (;;)
    {
        if ( var_2 == var_0 || var_2 == var_1 )
        {
            var_2 = randomintrange( 1, 4 );
            continue;
        }

        break;
    }

    if ( var_2 == 1 )
        level.bad_constants_loc3._id_00B9 = "red";
    else if ( var_2 == 2 )
        level.bad_constants_loc3._id_00B9 = "green";
    else
        level.bad_constants_loc3._id_00B9 = "blue";
}

set_not_equal_constant( var_0 )
{
    if ( level.bad_constants_loc1._id_00B9 == var_0 )
    {
        setomnvar( level.bad_constants_loc1._id_C4A1, 1 );
        setomnvar( level.bad_constants_loc2._id_C4A1, 0 );
        setomnvar( level.bad_constants_loc3._id_C4A1, 0 );
    }
    else if ( level.bad_constants_loc2._id_00B9 == var_0 )
    {
        setomnvar( level.bad_constants_loc1._id_C4A1, 0 );
        setomnvar( level.bad_constants_loc2._id_C4A1, 1 );
        setomnvar( level.bad_constants_loc3._id_C4A1, 0 );
    }
    else if ( level.bad_constants_loc3._id_00B9 == var_0 )
    {
        setomnvar( level.bad_constants_loc1._id_C4A1, 0 );
        setomnvar( level.bad_constants_loc2._id_C4A1, 0 );
        setomnvar( level.bad_constants_loc3._id_C4A1, 1 );
    }
    else if ( var_0 == "full" )
    {
        setomnvar( level.bad_constants_loc1._id_C4A1, 0 );
        setomnvar( level.bad_constants_loc2._id_C4A1, 0 );
        setomnvar( level.bad_constants_loc3._id_C4A1, 0 );
    }
}

select_pi_value()
{
    var_0 = randomintrange( 2, 8 );
    var_1 = 0;

    for (;;)
    {
        var_2 = tablelookupbyrow( "cp/zombies/diapi_table.csv", var_1, 1 );

        if ( var_2 == "" )
            break;

        if ( int( var_2 ) == level.constant_value )
        {
            level.constant_pi_value = int( tablelookupbyrow( "cp/zombies/diapi_table.csv", var_1, var_0 ) );
            break;
        }

        var_1++;
    }

    setomnvar( "zm_chem_pi_constant", level.constant_pi_value );
    setup_color_key();
}

setup_color_key()
{
    level.color_key_value = int( level.constant_pi_value * level.constant_value );
    setomnvar( "zm_chem_color_key_value", level.color_key_value );
    var_0 = randomintrange( 1, 5 );
    setomnvar( "zm_chem_color_key_rnd", var_0 );
    var_1 = randomintrange( 1, 4 );
    setomnvar( "zm_chem_color_key_slot", var_1 );
}

build_vo_clues_from_final_compound()
{

}

parse_compound_vo_table()
{
    level.bomb_compound.radio1 = [];
    level.bomb_compound.radio2 = [];
    var_0 = randomintrange( 1, 3 );

    if ( var_0 == 2 )
        level.radio_flip = 1;

    var_1 = randomintrange( 4, 8 );

    if ( isdefined( level.final_compound_vo_table ) )
        var_2 = level.final_compound_vo_table;
    else
        var_2 = "cp/zombies/chem_vo.csv";

    level.intro_chem_vo = [];
    var_3 = 0;

    for (;;)
    {
        var_4 = tablelookupbyrow( var_2, var_3, 0 );

        if ( var_4 == "" )
            break;

        if ( var_4 == level.bomb_compound.name )
        {
            var_4 = tablelookupbyrow( var_2, var_3, 0 );
            var_5 = tablelookupbyrow( var_2, var_3, 1 );
            var_6 = tablelookupbyrow( var_2, var_3, var_1 );
            var_7 = tablelookupbyrow( var_2, var_3, 2 );
            register_compound_vo( var_4, var_5, var_6, var_7 );
        }
        else if ( var_4 == "intro" )
        {
            var_4 = tablelookupbyrow( var_2, var_3, 0 );
            var_5 = tablelookupbyrow( var_2, var_3, 1 );
            var_6 = tablelookupbyrow( var_2, var_3, var_1 );
            var_7 = tablelookupbyrow( var_2, var_3, 2 );
            register_intro_chem_vo( var_4, var_5, var_6, var_7 );
        }

        var_3++;
    }

    level.bomb_compound.radio2 = scripts\engine\utility::_id_22A8( level.bomb_compound.radio2 );
}

register_compound_vo( var_0, var_1, var_2, var_3 )
{
    if ( var_1 == "7" )
    {
        var_4 = level.bomb_compound.radio1.size;
        level.bomb_compound.radio1[var_4] = spawnstruct();
        level.bomb_compound.radio1[var_4]._id_10475 = var_2;
        level.bomb_compound.radio1[var_4].radio = var_1;
        level.bomb_compound.radio1[var_4].tempstring = var_3;
    }
    else if ( var_1 == "8" )
    {
        var_4 = level.bomb_compound.radio2.size;
        level.bomb_compound.radio2[var_4] = spawnstruct();
        level.bomb_compound.radio2[var_4]._id_10475 = var_2;
        level.bomb_compound.radio2[var_4].radio = var_1;
        level.bomb_compound.radio2[var_4].tempstring = var_3;
    }
}

register_intro_chem_vo( var_0, var_1, var_2, var_3 )
{
    var_4 = level.intro_chem_vo.size;
    level.intro_chem_vo[var_4] = spawnstruct();
    level.intro_chem_vo[var_4]._id_10475 = var_2;
    level.intro_chem_vo[var_4].order = var_1;
    level.intro_chem_vo[var_4].tempstring = var_3;
}
