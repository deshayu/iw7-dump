// IW7 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

cp_final_onzombiedamaged( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11 )
{
    if ( isdefined( var_5 ) && var_5 == "iw7_entangler_zm" )
        return;

    var_12 = self;

    if ( !isdefined( self.agent_type ) )
        return;

    if ( var_4 != "MOD_SUICIDE" )
    {
        if ( scripts\mp\mp_agent::_id_9BEA( var_12, var_1 ) )
            return;

        if ( scripts\mp\mp_agent::_id_9BEA( var_12, var_0 ) )
            return;
    }

    if ( !isdefined( var_1 ) )
        var_1 = self;

    var_13 = _id_0CBC::_id_FF2E( var_1, var_2, var_4, var_5, var_8, var_12 );

    if ( !var_13 )
        return;

    var_14 = level._id_13BD3;
    var_15 = scripts\engine\utility::_id_9CEE( var_12.hit_by_dodging_player );
    var_16 = var_4 == "MOD_MELEE";
    var_17 = scripts\engine\utility::_id_9CEE( var_1._id_98F3 );
    var_18 = scripts\engine\utility::_id_9CEE( var_12._id_9CDD );
    var_3 = var_3 | 4;
    var_19 = isdefined( var_1 ) && isplayer( var_1 );
    var_20 = scripts\engine\utility::_id_9D74( var_4 ) || var_4 == "MOD_EXPLOSIVE_BULLET" && var_8 != "none";
    var_21 = var_20 && _id_0A77::isheadshot( var_5, var_8, var_4, var_1 );
    var_22 = scripts\engine\utility::_id_9CEE( self._id_28E0 );
    var_23 = scripts\engine\utility::_id_9CEE( level._id_9925 ) && !_id_0A77::agentisinstakillimmune();
    var_24 = var_4 == "MOD_EXPLOSIVE_BULLET" && ( isdefined( var_8 ) && var_8 == "none" ) || var_4 == "MOD_EXPLOSIVE" || var_4 == "MOD_GRENADE_SPLASH" || var_4 == "MOD_PROJECTILE" || var_4 == "MOD_PROJECTILE_SPLASH";
    var_25 = !var_17 && var_21 && var_20 && var_1 _id_0A77::_id_9BA0( "headshot_explosion" );
    var_26 = var_16 && var_1 _id_0A77::_id_9BA0( "increased_melee_damage" );
    var_27 = var_16 && var_1 _id_0A77::_id_9BA0( "shock_melee_upgrade" );
    var_28 = _id_0A77::_id_9D3E( var_5 );
    var_29 = _id_0A77::agentisfnfimmune();
    var_30 = _id_0A77::agentisinstakillimmune();
    var_31 = var_19 && var_1 _id_0A77::_id_8BBE( "perk_machine_change" );
    var_32 = _id_0A77::agentisspecialzombie();
    var_33 = isdefined( self.agent_type ) && self.agent_type == "alien_rhino";

    if ( isdefined( var_5 ) && issubstr( var_5, "iw7_gauss_zml" ) )
    {
        var_34 = 250;

        if ( _id_0A77::_id_13C90( var_5, "pap1" ) )
            var_34 = 470;

        if ( _id_0A77::_id_13C90( var_5, "pap2" ) )
            var_34 = 734;

        if ( _id_0A77::_id_13C90( var_5, "doubletap" ) )
            var_34 = 1.33 * var_34;

        if ( var_2 >= var_34 )
            self.hitbychargedshot = var_1;
    }

    if ( var_19 && !var_29 )
    {
        if ( scripts\engine\utility::_id_9CEE( self.marked_shared_fate_fnf ) )
            var_1 thread _id_0A77::add_to_notify_queue( "weapon_hit_marked_target", var_1, var_2, var_4, var_5, self );

        self.damaged_by_player = 1;

        if ( scripts\engine\utility::_id_9CEE( var_1.stimulus_active ) )
        {
            playfx( level._effect["stimulus_glow_burst"], self gettagorigin( "j_spineupper" ) );
            scripts\engine\utility::_id_CE2B( "zmb_fnf_stimulus", self gettagorigin( "j_spineupper" ) );

            foreach ( var_36 in level.players )
            {
                if ( var_36 == var_1 )
                {
                    if ( distance2dsquared( var_36.origin, self.origin ) <= 10000 )
                    {
                        playfx( level._effect["stimulus_glow_burst"], self gettagorigin( "j_spineupper" ) );
                        playfx( level._effect["stimulus_shield"], var_36 gettagorigin( "tag_eye" ), anglestoforward( var_36.angles ), anglestoup( var_36.angles ), var_36 );

                        if ( var_2 >= self.health )
                        {
                            if ( scripts\engine\utility::_id_9CEE( var_36._id_98F3 ) )
                                _id_0D59::revive_downed_entities( var_36 );
                        }

                        if ( var_36.health + var_2 / ( level.players.size + 1 ) >= var_36.maxhealth )
                            var_36.health = var_36.maxhealth;
                        else
                            var_36.health = int( var_36.health + var_2 / ( level.players.size + 1 ) );
                    }

                    continue;
                }

                if ( distance2dsquared( var_36.origin, self.origin ) <= 10000 )
                {
                    playfx( level._effect["stimulus_glow_burst"], self gettagorigin( "j_spineupper" ) );
                    playfx( level._effect["stimulus_shield"], var_36 gettagorigin( "tag_eye" ) );

                    if ( var_2 >= self.health )
                    {
                        if ( scripts\engine\utility::_id_9CEE( var_36._id_98F3 ) )
                            _id_0D59::revive_downed_entities( var_36 );
                    }

                    if ( int( var_36.health + var_2 / ( level.players.size + 1 ) ) >= var_36.maxhealth )
                    {
                        var_36.health = var_36.maxhealth;
                        continue;
                    }

                    var_36.health = int( var_36.health + var_2 / ( level.players.size + 1 ) );
                }
            }
        }
    }

    if ( isdefined( var_1._id_9CEF ) && var_1._id_9CEF && var_4 != "MOD_SUICIDE" )
        var_2 = var_1._id_B57A;

    var_38 = 0;

    if ( !var_16 && _id_0CBC::checkaltmodestatus( var_5 ) && var_19 && !isdefined( var_1._id_AD2C ) && var_1 _id_0A77::_id_9BA0( "sniper_soft_upgrade" ) )
        var_38 = var_1 _id_0A77::_id_4626( var_5 ) == "weapon_sniper";

    var_39 = !var_29 && scripts\engine\utility::_id_9CEE( level._id_69FA ) && isdefined( var_4 ) && var_4 == "MOD_UNKNOWN";
    var_40 = isdefined( var_5 ) && var_5 == "iw7_entangler2_zm";
    var_41 = !var_30 && ( var_22 || var_23 || var_27 || var_39 || var_25 || var_26 || var_38 );
    var_42 = scripts\engine\utility::_id_9CEE( self._id_9E0C );

    if ( var_41 && !var_29 )
    {
        if ( var_38 )
            var_1 _id_0A77::_id_C151( "sniper_soft_upgrade" );

        var_2 = int( self.maxhealth );

        if ( var_27 )
        {
            if ( isdefined( var_6 ) )
                playfx( level._effect["shock_melee_impact"], var_6 );

            var_1 thread _id_0D4A::_id_11193( self geteye(), self, self.maxhealth, "MOD_UNKNOWN", undefined, var_27 );
        }

        if ( var_20 )
            var_1 thread _id_0A77::add_to_notify_queue( "weapon_hit_enemy", self, var_1, var_5, var_2, var_8, var_4 );
    }
    else
    {
        var_8 = _id_0CBC::_id_FE39( var_1, var_4, var_5, var_8 );
        var_43 = _id_0CBC::_id_9BF7( var_5, var_4 );
        var_44 = scripts\engine\utility::_id_9CEE( self._id_9B81 ) && !var_20;
        var_45 = var_21 && var_1 _id_0A77::_id_9BA0( "sharp_shooter_upgrade" );
        var_46 = var_20 && var_1 _id_0A77::_id_9BA0( "bonus_damage_on_last_bullets" );
        var_47 = var_20 && var_1 _id_0A77::_id_9BA0( "damage_booster_upgrade" );
        var_48 = var_20 && isdefined( var_1.special_ammo_weapon ) && var_1.special_ammo_weapon == var_5;
        var_49 = var_19 && var_1 _id_0A77::_id_8BBE( "perk_machine_boom" );
        var_50 = var_19 && var_1 _id_0A77::_id_8BBE( "perk_machine_smack" );
        var_51 = scripts\engine\utility::array_contains( level.melee_weapons, var_5 );
        var_52 = weaponclass( var_5 ) == "spread" && var_1 _id_0A6B::_id_8BD1( var_5, "smart" );
        var_53 = weaponclass( var_5 ) == "spread" && !var_52 && ( var_1 _id_0A6B::_id_8BD1( var_5, "arkpink" ) || _id_0A6B::_id_8BD1( var_5, "arkyellow" ) );
        var_54 = var_21 && var_20 && var_1 _id_0A6B::_id_8BD1( var_5, "highcal" );

        if ( issubstr( var_5, "cutie" ) && var_19 )
        {
            var_55 = 7000;
            self.ragdollhitloc = var_8;

            if ( !isdefined( var_7 ) )
                var_7 = vectornormalize( self.origin - var_1.origin );

            if ( lengthsquared( var_7 ) < 1 )
            {
                var_56 = self.origin - var_1.origin;
                var_56 = vectornormalize( ( var_56[0], var_56[1], var_56[2] ) );
                self.ragdollimpactvector = var_56 * var_55;
            }
            else
                self.ragdollimpactvector = var_7 * var_55;
        }

        if ( var_28 && issubstr( var_5, "+gl" ) )
            var_2 = _id_0CBC::scalegldamage( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11 );

        if ( var_52 )
            var_2 = var_2 * 0.5;

        var_2 = _id_0CBC::_id_9830( undefined, var_1, var_2, undefined, var_4, var_5, undefined, undefined, var_8, undefined, undefined, undefined );

        if ( var_53 )
            var_2 = var_2 * 4;

        if ( var_19 )
        {
            if ( var_16 )
            {
                var_2 = int( var_2 * var_1 _id_0CFC::_id_CA3A() );

                if ( isdefined( var_1.passive_melee_kill_damage ) )
                    var_2 = var_2 + var_1.passive_melee_kill_damage;

                if ( var_50 )
                    var_2 = var_2 + 1500;

                var_57 = 0;

                if ( var_2 >= self.health )
                    var_57 = 1;

                if ( isdefined( var_1.increased_melee_damage ) )
                    var_2 = var_2 + var_1.increased_melee_damage;

                if ( var_51 && var_57 )
                    var_1 thread _id_0A77::add_to_notify_queue( "melee_weapon_hit", var_5, self, var_2 );

                if ( var_50 )
                {
                    if ( var_57 )
                        self._id_102CD = 1;
                }
            }

            if ( var_48 )
                var_1 thread _id_0D4A::_id_11193( self geteye(), self, var_2, var_4, 128 );

            if ( var_49 && var_24 )
                var_2 = int( var_2 * 2 );

            if ( isdefined( var_1.stimulus_damage_buff ) )
                var_2 = int( var_2 * 4 );
        }

        if ( var_45 )
            var_2 = var_2 * 3.0;

        if ( var_46 )
        {
            var_58 = int( var_1 getweaponammoclip( var_1 getcurrentweapon() ) + 1 );
            var_59 = weaponclipsize( var_1 getcurrentweapon() );

            if ( var_58 <= 4 )
                var_2 = var_2 * 2;
        }

        if ( var_20 && scripts\engine\utility::_id_9CEE( var_1._id_DF50 ) && !var_33 )
            var_2 = var_2 * 2;

        if ( var_43 )
            var_2 = var_2 * min( 2 + var_14 * 0.5, 10 );

        if ( var_47 )
        {
            if ( self.agent_type == "alien_goon" || self.agent_type == "alien_phantom" || self.agent_type == "karatemaster" || !var_32 )
                var_2 = int( var_2 * 2 );
        }

        if ( var_54 )
            var_2 = var_2 * 1.2;

        if ( var_19 && var_15 && !var_32 )
        {
            if ( !isdefined( self._id_AAA8 ) )
            {
                var_55 = 7000;
                self.kung_fu_punched = 1;
                self.ragdollhitloc = var_8;

                if ( !isdefined( var_7 ) )
                    var_7 = vectornormalize( self.origin - var_1.origin );

                if ( lengthsquared( var_7 ) < 1 )
                {
                    var_56 = self.origin - var_1.origin;
                    var_56 = vectornormalize( ( var_56[0], var_56[1], var_56[2] ) );
                    self.ragdollimpactvector = var_56 * var_55;
                }
                else
                    self.ragdollimpactvector = var_7 * var_55;

                var_2 = 100000000;
            }
        }
    }

    var_60 = isdefined( var_5 ) && var_5 == "ghost_grenade_launcher";

    if ( isdefined( var_1._id_CA2F ) && var_1._id_CA2F["damagemod"]._id_3237 == 2.0 && var_20 )
        var_2 = var_2 * 1.33;

    if ( scripts\engine\utility::_id_9CEE( var_1.deadeye_charge ) )
        var_2 = var_2 * 1.25;

    if ( isdefined( level._id_4D0F ) )
    {
        if ( !scripts\engine\utility::_id_6E25( "start_tracking_dps" ) )
            scripts\engine\utility::_id_6E3E( "start_tracking_dps" );

        if ( isdefined( level._id_5B0F ) )
            level._id_5B0F = gettime();

        if ( isdefined( var_1._id_11A22 ) )
            var_1._id_11A22 = var_1._id_11A22 + var_2;
    }

    var_2 = _id_0CBC::_id_FFBC( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11 );
    var_33 = isdefined( self.agent_type ) && self.agent_type == "alien_rhino";
    var_2 = finalfateandfortuneweaponscale( self, var_5, var_2, 0, var_32, var_33, 0 );

    if ( isdefined( var_1.special_zombie_damage ) && var_32 )
        var_2 = var_2 * var_1.special_zombie_damage;

    if ( var_60 )
        var_2 = ghostgrenadescaler( self, var_2 );

    if ( var_40 )
    {
        self._id_6E82 = gettime() + 500;

        if ( isdefined( level._id_13BD6 ) )
            var_61 = level._id_13BD6;
        else
            var_61 = var_14;

        var_62 = int( clamp( var_61 / 5, 1, 4 ) );

        if ( var_32 )
            var_2 = 1;
        else
        {
            if ( var_62 > 1 )
                var_2 = self.maxhealth * ( 0.1 / var_62 );
            else
                var_2 = self.maxhealth * 0.1;

            if ( isfataldamage( self, var_2 ) )
                self.entangled = 1;
        }
    }

    if ( isdefined( self.hitbychargedshot ) && !isfataldamage( self, var_2 ) )
        self.hitbychargedshot = undefined;

    var_2 = int( min( var_2, self.health ) );

    if ( isplayer( var_1 ) && _id_0A77::_id_9C42( var_5, 1 ) )
        playfx( level._effect["melee_impact"], self gettagorigin( "j_neck" ), vectortoangles( self.origin - var_1.origin ), anglestoup( self.angles ), var_1 );

    if ( self.health > 0 && self.health - var_2 <= 0 )
    {
        if ( self._id_54CB )
            self.died_poorly_health = self.health;

        if ( isdefined( self._id_8B66 ) )
            _id_0D5E::_id_CB84( self, self._id_8B66, var_1 );

        if ( var_40 && scripts\engine\utility::_id_9CEE( self.entangled ) )
            self._id_C026 = 1;

        if ( var_19 && var_31 )
        {
            if ( isdefined( self.agent_type ) && self.agent_type == "generic_zombie" )
            {
                if ( issubstr( var_5, "entangler" ) )
                {

                }
                else if ( var_5 == "iw7_change_chews_zm" )
                {
                    self._id_C026 = 1;
                    self._id_74B5 = 1;
                }
                else if ( var_21 )
                {
                    var_63 = 50;

                    if ( randomint( 100 ) < var_63 )
                    {
                        switch ( var_1.sub_perks["perk_machine_change"] )
                        {
                            case "perk_machine_change1":
                                playfx( level._effect["cc_head_nuke"], var_6 );
                                playloopsound( var_6, "change_chew_nuke_explo" );
                                var_1 thread change_chews_damage_over_time( self, var_1, 96, "explode" );
                                break;
                            case "perk_machine_change2":
                                playfx( level._effect["cc_zap_burst"], var_6 );
                                playloopsound( var_6, "change_chew_electric_explo" );
                                var_1 thread change_chews_damage_over_time( self, var_1, 196, "shocked" );
                                break;
                            case "perk_machine_change3":
                                playfx( level._effect["cc_fire_burst"], var_6 );
                                playloopsound( var_6, "change_chew_fire_explo" );
                                var_1 thread change_chews_damage_over_time( self, var_1, 128, "burning" );
                                break;
                            case "perk_machine_change4":
                                playfx( level._effect["cc_ice_burst"], var_6 );
                                var_1 thread change_chews_damage_over_time( self, var_1, 128, "frozen" );
                                break;
                            default:
                                break;
                        }
                    }
                }
            }
        }

        if ( isdefined( self.agent_type ) && self.agent_type == "alien_goon" )
        {
            if ( var_4 == "MOD_SUICIDE" )
                self.vignette_nocorpse = 1;
            else
                self._id_CE65 = 0.05;
        }
        else if ( isdefined( self.agent_type ) && self.agent_type == "alien_phantom" )
            self._id_CE65 = 0.05;
    }

    if ( var_19 )
    {
        if ( isdefined( level._id_12EDE ) )
            level thread [[ level._id_12EDE ]]( var_1, var_5, self );

        var_1 thread _id_0A77::add_to_notify_queue( "weapon_hit_enemy", self, var_1, var_5, var_2, var_8, var_4 );
        var_1 thread _id_0CBC::_id_12EC5( getweaponbasename( var_5 ) );

        if ( var_20 )
        {
            if ( !isdefined( var_1._id_154B ) )
                var_1._id_154B = 1;
            else
                var_1._id_154B++;

            _id_0A63::increment_player_career_shots_on_target( var_1 );
            _id_0D45::log_playershotsontarget( 1, var_1, var_1._id_154B );
        }

        if ( !isdefined( var_1._id_FF0A[getweaponbasename( var_5 )] ) )
            var_1._id_FF0A[getweaponbasename( var_5 )] = 1;
        else
            var_1._id_FF0A[getweaponbasename( var_5 )]++;
    }

    _id_0D5A::_id_12D84( var_1, var_2, var_4 );
    _id_0A4A::_id_D96D( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_12 );

    if ( isdefined( self.agent_type ) && isdefined( level.damage_feedback_overrride ) && isdefined( level.damage_feedback_overrride[self.agent_type] ) )
        [[ level.damage_feedback_overrride[self.agent_type] ]]( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_12 );
    else
        _id_0A4A::_id_D96B( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_12 );

    _id_0A4A::_id_110A4( var_1, var_2 );
    _id_0D63::_id_1094D( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11 );

    if ( var_19 )
        thread _id_0CBC::_id_BF05( var_1 );

    if ( isdefined( self.is_mammoth ) && self.is_mammoth )
    {
        if ( self.health - var_2 < self.maxhealth * self.mammoth_health_threshold )
            self notify( "mammoth_hit", self );
    }

    var_12 [[ level.agent_funcs[var_12.agent_type]["on_damaged_finished"] ]]( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, 0.0, var_10, var_11 );
}

isfataldamage( var_0, var_1 )
{
    return var_0.health - var_1 < 1;
}

finalfateandfortuneweaponscale( var_0, var_1, var_2, var_3, var_4, var_5, var_6 )
{
    if ( !isdefined( var_1 ) )
        return var_2;

    var_7 = getweaponbasename( var_1 );

    if ( isdefined( var_7 ) )
    {
        switch ( var_7 )
        {
            case "iw7_steeldragon_mp":
            case "iw7_claw_mp":
                if ( var_5 )
                    var_2 = min( max( var_0.maxhealth * 0.05, 100 ), 150 );
                else if ( var_3 || var_6 || var_0 _id_0A77::agentisinstakillimmune() )
                    var_2 = min( max( var_0.maxhealth * 0.05, 300 ), 5 );
                else
                    var_2 = min( max( var_0.maxhealth, 300 ), 1000 );

                break;
            case "iw7_blackholegun_mp":
                if ( var_5 || var_6 || var_0 _id_0A77::agentisinstakillimmune() )
                    var_2 = min( max( var_0.maxhealth * 0.15, 300 ), 1000 );
                else if ( var_4 && var_0.agent_type != "alien_goon" && var_0.agent_type != "karatemaster" )
                    var_2 = min( var_2 * 10, 2000 );
                else
                    var_2 = var_2 * 10;

                break;
            case "iw7_atomizer_mp":
            case "iw7_penetrationrail_mp":
                if ( var_3 || var_6 || var_5 || var_0 _id_0A77::agentisinstakillimmune() )
                    var_2 = min( max( var_0.maxhealth * 0.15, 300 ), 1000 );
                else if ( var_4 && var_0.agent_type != "alien_goon" && var_0.agent_type != "karatemaster" )
                    var_2 = var_0.maxhealth / 10;
                else
                    var_2 = var_0.maxhealth;

                break;
            default:
                return var_2;
        }
    }

    return var_2;
}

cp_final_initial_weapon_scale( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11 )
{
    if ( !_id_0CBC::_id_3845( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11 ) )
        return var_2;

    var_12 = isdefined( self.agent_type ) && self.agent_type == "alien_rhino";

    if ( isdefined( var_5 ) )
    {
        if ( isdefined( var_4 ) && var_4 == "MOD_MELEE" )
        {
            if ( isdefined( level.melee_weapons ) && scripts\engine\utility::array_contains( level.melee_weapons, getweaponbasename( var_5 ) ) )
                return var_2;
            else if ( issubstr( getweaponbasename( var_5 ), "rvn" ) )
            {
                var_2 = min( self.maxhealth, var_2 );
                return var_2;
            }

            if ( !_id_0CBC::_id_9B73( var_5 ) )
                var_2 = 150;

            return var_2;
        }
        else if ( var_5 == "alien_sentry_minigun_4_mp" )
        {
            if ( scripts\engine\utility::_id_9CEE( self.is_mammoth ) )
                var_2 = min( int( self.maxhealth / 5 * randomfloatrange( 0.75, 1.25 ) ), 100 );
            else if ( var_12 )
                var_2 = min( int( self.maxhealth / 5 * randomfloatrange( 0.75, 1.25 ) ), 250 );
            else
                var_2 = int( self.maxhealth / 2 * randomfloatrange( 0.75, 1.25 ) );
        }

        return var_2;
    }

    return var_2;
}

ghostgrenadescaler( var_0, var_1 )
{
    var_1 = var_1 * 1.25 / 150;
    var_1 = var_1 * var_0.maxhealth;
    return var_1;
}

entanglezombie( var_0, var_1 )
{
    level endon( "game_ended" );
    var_1.hasghostentangled = 1;
    playfx( level._effect["chi_ghost_death"], var_0.origin, anglestoforward( var_0.angles ), anglestoup( var_0.angles ) );
    var_2 = spawn( "script_model", var_0.origin );
    var_2.angles = var_0.angles;
    var_2 setmodel( "zmb_zombie_ghost_green" );

    if ( var_1 _id_0A77::isweaponfireenabled() )
        var_1 scripts\engine\utility::_id_1C46( 0 );

    if ( var_1 _id_0A77::issprintenabled() )
        var_1 scripts\engine\utility::_id_1C67( 0 );

    var_1 notifyonplayercommand( "item_released", "-attack" );
    var_1 setscriptablepartstate( "entangler", "active" );
    var_3 = playfxontagsbetweenclients( level._effect["entangler_beam"], var_1, "tag_flash", var_2, "j_chest" );
    var_2 thread moveghosttowardsplayer( var_2, var_1 );
    ghostidleloop( var_2, var_1 );
    var_1 notify( "end_move_towards_player" );
    var_1 setscriptablepartstate( "entangler", "fired" );

    if ( isdefined( var_1 ) && !var_1 _id_0A77::isweaponfireenabled() )
        var_1 scripts\engine\utility::_id_1C46( 1 );

    if ( isdefined( var_1 ) && !var_1 _id_0A77::issprintenabled() )
        var_1 scripts\engine\utility::_id_1C67( 1 );

    var_3 delete();
    _id_AAAD( var_2.origin, var_2.angles, undefined, var_1, var_2 );

    if ( isdefined( var_1 ) )
        var_1.hasghostentangled = undefined;
}

delaykillghost( var_0, var_1 )
{
    level endon( "game_ended" );
    var_1 waittill( "death" );
    var_2 = var_1.origin;
    _id_0A77::playsoundatpos_safe( var_2, "ghosts_ghosts_8bit_target_explo" );

    if ( isdefined( var_0 ) )
        var_0 delete();
}

#using_animtree("cp_dlc4_entangler");

ghostidleloop( var_0, var_1 )
{
    level endon( "game_ended" );
    var_1 endon( "disconnect" );
    var_1 endon( "end_Ghost_Idle_Loop" );
    var_1 endon( "entangler_removed" );
    var_1 endon( "item_released" );
    level endon( "entangler_removed_" + var_1.name );

    for (;;)
    {
        var_0 scriptmodelplayanim( "IW7_cp_zom_ghost_trapped_idle", 1 );
        var_2 = getanimlength( %iw7_cp_zom_ghost_trapped_idle );
        wait( var_2 );
    }
}

moveghosttowardsplayer( var_0, var_1 )
{
    var_1 endon( "disconnect" );
    var_1 endon( "end_Ghost_Idle_Loop" );
    var_0 endon( "death" );
    var_1 endon( "item_released" );
    wait 0.1;
    var_2 = 1250;
    var_3 = 0;
    var_4 = 96;
    var_5 = 0;
    var_6 = var_0;
    var_7 = 1;
    var_8 = scripts\engine\trace::_id_48BC( 0, 1, 1, 1, 0, 0, 1 );
    var_9 = scripts\engine\trace::_id_48BC( 1, 1, 1, 1, 1, 0, 0 );
    var_10 = scripts\cp\crafted_entangler::getcapsulefrommodel( var_6 );
    var_6 endon( "end_entangle_move_to_logic" );
    var_6 endon( "item_released" );
    var_6.lasteffecttime = 0;

    if ( isdefined( var_6._id_EE79 ) && var_6._id_EE79 == "heavy_helmet" )
    {
        var_4 = 100;
        var_2 = 250;
        var_7 = 0;
    }

    playfxontag( level._effect["vfx_item_entagled"], var_6, "j_chest" );
    thread scripts\cp\crafted_entangler::delaykillfx( var_6, "j_chest", var_1 );
    thread monitorplayerviewangles( var_1, var_0 );

    for ( var_11 = 0; var_1 getcurrentweapon() == "iw7_entangler2_zm"; var_11++ )
    {
        var_12 = gettime();

        if ( var_6.lasteffecttime + 250 <= var_12 )
            var_6.lasteffecttime = var_12;

        var_4 = 96;
        var_13 = var_1 _meth_816B();
        var_14 = vectordot( var_13, var_1.angles );

        if ( var_14 >= 1 )
        {
            var_15 = length( var_13 );

            if ( var_15 >= 250 )
                var_4 = var_4 + 60;
            else if ( var_15 >= 185 )
                var_4 = var_4 + 36;
            else if ( var_15 >= 100 )
                var_4 = var_4 + 24;
        }

        var_16 = var_11 >= 5;
        var_17 = [ var_6 ];
        var_18 = var_1 geteye();
        var_19 = var_1.origin + ( 0, 0, 56 );
        var_20 = ( 0, var_4, 0 );
        var_21 = var_1 getplayerangles();
        var_22 = anglestoforward( var_21 );
        var_23 = anglestoup( var_21 );
        var_24 = anglestoright( var_21 );
        var_25 = var_5;
        var_19 = var_19 + var_20[0] * var_24;
        var_19 = var_19 + var_20[1] * var_22;
        var_19 = var_19 + var_20[2] * var_23;
        var_26 = rotatepointaroundvector( anglestoup( var_21 ), anglestoforward( var_21 ), var_25 );
        var_27 = var_19 + var_26;
        var_28 = var_27[2];
        var_29 = scripts\engine\utility::_id_5D14( var_18, 12, -100 )[2];
        var_30 = min( var_18[2], var_29 + 12 );
        var_28 = clamp( var_27[2], var_29, var_30 );
        var_27 = ( var_27[0], var_27[1], var_28 );
        var_31 = vectortoangles( var_1.origin - var_6.origin );
        var_6.angles = ( var_31[0], var_31[1], var_31[2] );

        if ( var_16 )
        {
            var_32 = var_6.origin + anglestoforward( vectortoangles( var_1.origin - var_6.origin ) ) * 12;
            var_33 = scripts\engine\trace::_id_3A09( var_32, var_27, var_10[0], var_10[1], undefined, var_17, var_8, 1 );
            var_27 = var_33["shape_position"] - ( 0, 0, var_33["shape_position"][2] ) + ( 0, 0, var_28 );
        }

        var_34 = distance( var_6.origin, var_27 );
        var_3 = var_34 / var_2;

        if ( var_3 < 0.05 )
            var_3 = 0.05;

        if ( scripts\engine\utility::_id_9CEE( var_1._id_9C54 ) || scripts\engine\utility::_id_9CEE( var_1.isfasttravelling ) )
        {
            var_6 dontinterpolate();
            var_16 = 0;
            var_11 = 0;
            var_6.origin = var_27;
        }
        else if ( var_34 <= 64 )
            var_6.origin = var_27;
        else
        {
            var_6 moveto( var_27, var_3 );
            var_1 scripts\engine\utility::_id_13736( var_3, "update_ghost_pos" );
        }

        if ( var_16 )
        {
            var_32 = var_6.origin + anglestoforward( var_6.angles ) * 18;
            var_17 = scripts\engine\utility::_id_227F( level.players, [ var_6 ] );
            var_35 = scripts\engine\trace::_id_DCED( var_18, var_32 + ( 0, 0, 16 ), var_17, var_9 );

            if ( var_35["hittype"] != "hittype_none" )
            {
                var_6.forcerelease = 1;

                if ( isdefined( var_1 ) )
                {
                    var_1 notify( "end_Ghost_Idle_Loop" );
                    var_1 notify( "item_released" );
                }

                var_6 notify( "item_released" );
            }
        }

        scripts\engine\utility::waitframe();
    }

    var_1 notify( "end_Ghost_Idle_Loop" );
}

monitorplayerviewangles( var_0, var_1 )
{
    var_0 endon( "disconnect" );
    var_1 endon( "death" );
    var_0 endon( "end_Ghost_Idle_Loop" );

    for (;;)
    {
        var_2 = var_0 gettagorigin( "tag_flash" ) - ( 0, 0, 16 );
        var_3 = vectornormalize( anglestoforward( var_0.angles ) ) * 56;
        var_4 = var_2 + var_3;

        if ( distance( var_1.origin, var_4 ) >= 5 )
            var_0 notify( "update_ghost_pos" );

        scripts\engine\utility::waitframe();
    }
}

watchforattackbuttonpressed( var_0, var_1 )
{
    var_0 endon( "disconnect" );
    var_1 endon( "death" );
    var_0 endon( "end_Ghost_Idle_Loop" );
    var_0 notifyonplayercommand( "fire_released", "-attack" );
    var_0 notifyonplayercommand( "fire_released", "-attack_akimbo_accessible" );
    var_0 waittill( "fire_released" );
    var_0 notify( "end_Ghost_Idle_Loop" );
}

_id_AAAD( var_0, var_1, var_2, var_3, var_4 )
{
    level endon( "game_ended" );
    var_3 endon( "disconnect" );
    var_5 = var_3 geteye();
    var_6 = var_4.origin;
    var_7 = ( 0, 10000, 0 );
    var_8 = var_3 getplayerangles();
    var_9 = 2;
    var_6 = var_6 + var_7[0] * anglestoright( var_8 );
    var_6 = var_6 + var_7[1] * anglestoforward( var_8 );
    var_6 = var_6 + var_7[2] * anglestoup( var_8 );
    var_10 = rotatepointaroundvector( anglestoup( var_8 ), anglestoforward( var_8 ), var_9 );
    var_11 = scripts\engine\trace::_id_48BC( 1, 1, 1, 1, 0, 0, 0 );
    var_12 = scripts\engine\trace::_id_3A09( var_5, var_6 + var_10, 16, 32, undefined, [ var_3, var_4 ], var_11, 24 );
    var_13 = var_12["shape_position"];
    var_14 = magicbullet( "ghost_grenade_launcher", var_4.origin, var_13, var_3 );
    var_4 linkto( var_14, "tag_origin" );
    var_14.owner = var_3;
    var_14.team = var_3.team;
    var_14 setscriptablepartstate( "animation", "on" );
    thread delaykillghost( var_4, var_14 );
}

printgrenadedeath( var_0 )
{
    level endon( "game_ended" );
    var_0 waittill( "death", var_1, var_2, var_3 );
}

get_fake_ghost_color( var_0 )
{
    return var_0;
}

get_fake_ghost_model( var_0 )
{
    if ( isdefined( level.get_fake_ghost_model_func ) )
        return [[ level.get_fake_ghost_model_func ]]( var_0 );

    return "fake_zombie_ghost_" + var_0;
}

_id_CAFB( var_0, var_1 )
{
    var_0 endon( "death" );
    var_0 waittill( "collision", var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9 );
    _id_6AEC( var_0, var_1, _id_7ED4() );
}

_id_7ED4()
{
    return 7225;
}

_id_6AEC( var_0, var_1, var_2 )
{
    var_0 setscriptablepartstate( "animation", "off" );
    var_0 delete();
}

cp_final_onzombiekilled( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8 )
{
    if ( isdefined( self._id_1070B ) )
        self._id_1070B delete();

    if ( isdefined( self._id_EF89 ) )
    {
        self._id_EF89 delete();
        self._id_EF89 = undefined;
    }

    if ( scripts\engine\utility::_id_9CEE( self.activated_slomo_sphere ) )
        self.activated_slomo_sphere = undefined;

    if ( issubstr( var_4, "iw7_knife" ) && isplayer( var_1 ) && _id_0A77::_id_9C42( var_4 ) )
        var_1 thread _id_0CBC::_id_F640( var_1 );
    else if ( ( var_4 == "iw7_axe_zm" || var_4 == "iw7_axe_zm_pap1" || var_4 == "iw7_axe_zm_pap2" ) && isplayer( var_1 ) && _id_0A77::_id_9C42( var_4 ) )
        var_1 thread _id_0CBC::_id_F640( var_1 );
    else if ( issubstr( var_4, "golf" ) || issubstr( var_4, "machete" ) || issubstr( var_4, "spiked_bat" ) || issubstr( var_4, "two_headed_axe" ) )
        var_1 thread _id_0CBC::_id_F640( var_1 );

    if ( isdefined( var_1 ) && isplayer( var_1 ) && scripts\engine\utility::_id_9CEE( self.entangled ) && !scripts\engine\utility::_id_9CEE( var_1.hasghostentangled ) )
        thread entanglezombie( self, var_1 );

    if ( isdefined( self._id_AD2B ) )
    {
        self._id_AD2B._id_13F0E = undefined;
        self._id_AD2B = undefined;
    }

    if ( !isplayer( var_1 ) )
    {
        if ( isdefined( var_1.name ) )
        {
            if ( var_1.name == var_1.owner._id_A039 )
            {
                if ( isdefined( var_1.owner._id_A6C6[var_1.owner._id_A039] ) )
                    var_1.owner._id_A6C6[var_1.owner._id_A039]++;
            }
        }
    }

    if ( var_4 == "zmb_imsprojectile_mp" )
    {
        for ( var_9 = 0; var_9 < level._id_76CD; var_9++ )
        {
            if ( isdefined( level._id_76CC[var_9] ) )
            {
                if ( level._id_76CC[var_9]._id_A039 == "crafted_gascan" )
                {
                    if ( !isdefined( level._id_76CB[level._id_76CC[var_9].name] ) )
                    {
                        level._id_76CB[level._id_76CC[var_9].name] = 1;
                        continue;
                    }

                    level._id_76CB[level._id_76CC[var_9].name]++;
                }
            }
        }
    }

    if ( issubstr( var_4, "venomx" ) )
    {
        if ( scripts\engine\utility::_id_9CEE( self.dot_triggered ) )
            self.dot_triggered = undefined;
    }

    if ( isplayer( var_1 ) )
    {
        if ( scripts\engine\utility::_id_9CEE( self.marked_shared_fate_fnf ) )
        {
            self.marked_shared_fate_fnf = 0;
            var_1.marked_ents = scripts\engine\utility::array_remove( var_1.marked_ents, self );
            var_1 thread _id_0A77::add_to_notify_queue( "weapon_hit_marked_target", var_1, var_2, var_3, var_4, self );
            self setscriptablepartstate( "shared_fate_fx", "inactive", 1 );
        }

        if ( isdefined( var_1._id_13C37 ) && var_1._id_13C37 > 1 )
            var_1.kill_with_extra_xp_passive = 1;

        var_10 = var_3 == "MOD_EXPLOSIVE_BULLET" && ( isdefined( var_6 ) && var_6 == "none" ) || var_3 == "MOD_EXPLOSIVE" || var_3 == "MOD_GRENADE_SPLASH" || var_3 == "MOD_PROJECTILE" || var_3 == "MOD_PROJECTILE_SPLASH";

        if ( var_10 )
        {
            if ( !isdefined( var_1.explosive_kills ) )
                var_1.explosive_kills = 1;
            else
                var_1.explosive_kills++;

            _id_0A63::increment_player_career_explosive_kills( var_1 );
        }

        var_1.kills++;
        var_1._id_13C2F = _id_0A77::_id_7DF7( var_4 );

        if ( !isdefined( var_1._id_190B[var_1._id_13C2F] ) )
            var_1._id_190B[var_1._id_13C2F] = 1;
        else
            var_1._id_190B[var_1._id_13C2F]++;

        _id_0D45::_id_AF92( 1, level._id_13BD3, var_1, var_4, self.agent_type, self.origin );

        if ( scripts\engine\utility::_id_9D74( var_3 ) && var_4 != "incendiary_ammo_mp" && var_4 != "slayer_ammo_mp" )
        {
            if ( isdefined( var_6 ) && _id_0A77::isheadshot( var_4, var_6, var_3, var_1 ) )
                self playsoundtoplayer( "zmb_player_achieve_headshot", var_1 );
        }

        if ( isdefined( var_1._id_A035 ) )
        {
            foreach ( var_12 in level._id_D782 )
            {
                if ( var_12._id_13CE0 == var_4 )
                {
                    if ( var_12._id_13CE0 == var_1._id_A035 )
                    {
                        if ( isdefined( var_1._id_A034[var_1._id_A035] ) )
                        {
                            var_1._id_A034[var_1._id_A035]++;
                            continue;
                        }

                        var_1._id_A034[var_1._id_A035] = 1;
                    }
                }
            }
        }

        if ( isdefined( self._id_103F2 ) )
        {
            var_14 = 100;
            var_15 = 3;
            var_16 = self.origin + ( 0, 0, 20 );
            var_17 = ( randomint( 350 ), randomint( 350 ), randomint( 350 ) );
            var_17 = vectornormalize( var_17 ) * var_14;
            var_18 = self _meth_8449( "frag_grenade_zm", var_16, var_17, var_15 );
        }
    }

    if ( isdefined( var_1.team ) )
    {
        if ( var_1.team == "allies" )
        {
            if ( !isplayer( var_1 ) )
            {
                for ( var_9 = 0; var_9 < level._id_E4BD; var_9++ )
                {
                    if ( !isdefined( level._id_E4BB[level._id_E4BC[var_9].name] ) )
                    {
                        level._id_E4BB[level._id_E4BC[var_9].name] = 1;
                        continue;
                    }

                    level._id_E4BB[level._id_E4BC[var_9].name]++;
                }
            }
        }
    }

    if ( should_reset_scriptable_states_on_death() )
        _id_0D53::_id_1296F( self );

    if ( scripts\engine\utility::_id_6E34( "force_drop_max_ammo" ) && scripts\engine\utility::_id_6E25( "force_drop_max_ammo" ) && var_3 != "MOD_SUICIDE" )
    {
        if ( isdefined( level._id_5CF9 ) )
            level thread [[ level._id_5CF9 ]]( self.origin, var_1, "ammo_max", undefined, undefined, 1 );

        scripts\engine\utility::_id_6E2A( "force_drop_max_ammo" );
    }

    var_19 = 0;
    var_20 = 0;
    var_21 = 0;
    var_22 = scripts\engine\utility::_id_9CEE( self._id_9CDD );

    if ( isdefined( level._id_12EFF ) && isplayer( var_1 ) )
        var_1 thread [[ level._id_12EFF ]]( self, var_4 );

    if ( getweaponbasename( var_4 ) == "iw7_cutie_zm" && scripts\engine\utility::_id_9CEE( self.affectedbyfovdamage ) )
    {
        self playsound( "bullet_atomizer_impact_npc" );

        if ( isdefined( self._id_2C09 ) )
        {
            self._id_2C09 thread _id_0CBC::_id_CEF1();
            self._id_2C09 hide( 1 );
        }

        self.affectedbyfovdamage = undefined;
    }

    if ( scripts\engine\utility::_id_9D74( var_3 ) && ( getweaponbasename( var_4 ) == "iw7_atomizer_mp" || scripts\engine\utility::_id_9CEE( self.atomize_me ) ) || var_3 == "MOD_UNKNOWN" && getweaponbasename( var_4 ) == "iw7_harpoon3_zm" || var_3 == "MOD_UNKNOWN" && getweaponbasename( var_4 ) == "iw7_lasertrap_zm" )
    {
        if ( !var_22 && !var_19 && !var_20 && !var_21 && !_id_0A77::agentisfnfimmune() )
        {
            self playsound( "bullet_atomizer_impact_npc" );

            if ( isdefined( self._id_2C09 ) )
            {
                self._id_2C09 thread _id_0CBC::_id_CEF1();
                self._id_2C09 hide( 1 );
            }
        }
    }

    if ( isplayer( var_1 ) )
    {
        if ( isdefined( level.on_zombie_killed_quests_func ) )
            [[ level.on_zombie_killed_quests_func ]]( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8 );

        if ( isdefined( var_4 ) && var_4 == "iw7_knife_zm_cleaver" )
        {
            if ( iscrog( self ) )
            {
                if ( isdefined( level.crogs_cleaved ) )
                    level.crogs_cleaved++;

                level thread _id_0A77::add_to_notify_queue( "cleaver_kill", self, self.origin, var_4, var_3 );
            }
            else
                level thread _id_0A77::add_to_notify_queue( "cleaver_kill_zombie" );
        }

        var_1 thread _id_0A77::add_to_notify_queue( "zombie_killed", self, self.origin, var_4, var_3 );
    }

    if ( !_id_0CBC::_id_9EC6( self ) )
    {
        _id_0CBC::_id_6563( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8 );

        if ( isdefined( level._id_C5D3 ) )
            [[ level._id_C5D3 ]]( var_1, var_4 );
    }

    var_1 _id_0D59::_id_8C9D( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, self );

    if ( isdefined( level._id_108E1 ) )
        [[ level._id_108E1 ]]( var_1, var_4 );

    if ( isdefined( self._id_BE77 ) && !isdefined( self._id_1044D ) )
    {
        self._id_1044D = 1;

        if ( isdefined( var_1._id_A039 ) )
        {
            if ( var_1._id_A039 == "crafted_medusa" )
            {
                if ( !isdefined( var_1._id_A6C6[var_1._id_A039] ) )
                    var_1._id_A6C6[var_1._id_A039] = 1;
                else
                    var_1._id_A6C6[var_1._id_A039]++;
            }
        }

        level thread [[ level._id_B540 ]]( self.origin, self._id_BE77, scripts\engine\utility::_id_9CEE( self._id_565C ) );
    }

    if ( isdefined( self._id_BE74 ) && !var_22 )
    {
        if ( isdefined( level._id_4297 ) )
            var_23 = level [[ level._id_4297 ]]( self );
        else
            var_23 = undefined;

        if ( isdefined( var_23 ) )
        {
            if ( isdefined( level._id_4ADE ) )
                thread _id_0CBC::delayminiufocollection( self.origin, var_4, var_23 );
        }
    }

    if ( isdefined( level._id_DB5A ) )
        level thread [[ level._id_DB5A ]]( self );

    if ( isplayer( var_1 ) && isdefined( level._id_12EE0 ) )
        level thread [[ level._id_12EE0 ]]( var_4, var_1, self, var_3, var_6 );

    self _meth_818B();

    if ( isdefined( self._id_1E6E ) )
        self._id_1E6E delete();

    if ( isdefined( self._id_24CA ) )
        _id_0D4D::_id_DF34( self._id_24CA );

    self._id_4298 = undefined;
    self._id_24CA = undefined;
    self._id_DD16 = undefined;
    self._id_8C5F = undefined;
    self._id_E5C9 = undefined;
    self._id_5624 = undefined;
    self._id_12F77 = undefined;
    self._id_10166 = undefined;
    self._id_BE77 = undefined;

    if ( isplayer( var_1 ) )
    {
        if ( !scripts\engine\utility::_id_9CEE( level.completed_venomx_pap1_challenges ) )
        {
            if ( isdefined( level.cryptidkillswithvenomx ) )
            {
                if ( level.splchosenagent == "cryptids" && ( self.agent_type == "alien_goon" || self.agent_type == "alien_phantom" ) )
                {
                    if ( issubstr( var_4, "venomx" ) )
                    {
                        level thread _id_0A77::add_to_notify_queue( "venomx_kill", self, self.origin, var_4, var_3 );
                        level.cryptidkillswithvenomx++;
                    }
                }
            }
        }
        else if ( isdefined( level.cryptidkillswithvenomxpap2 ) )
        {
            if ( level.splchosenagentpap2 == "special.zombies" && ( self.agent_type == "alien_goon" || self.agent_type == "alien_phantom" || self.agent_type == "zombie_clown" || self.agent_type == "karatemaster" ) )
            {
                if ( level.cryptidkillswithvenomxpap2 >= level.chosen_number_for_morse_code_pap2 )
                    level.cryptidkillswithvenomxpap2 = level.chosen_number_for_morse_code_pap2;
                else if ( issubstr( var_4, "venomx" ) )
                {
                    level thread _id_0A77::add_to_notify_queue( "venomx_pap1_kill", self, self.origin, var_4, var_3 );
                    level.cryptidkillswithvenomxpap2++;
                }
            }
        }
    }

    if ( self.agent_type == "alien_goon" || self.agent_type == "alien_phantom" || self.agent_type == "alien_rhino" )
    {
        if ( getdvar( "scr_easy_egg_drop", "" ) != "" )
            level thread scripts\cp\maps\cp_final\cp_final_venomx_quest::spawn_egg_interaction_for_players( self.origin );
        else if ( randomint( 100 ) > 90 )
        {
            var_24 = 0;

            if ( isplayer( var_1 ) )
            {
                var_25 = var_1 _meth_8173();

                foreach ( var_27 in var_25 )
                {
                    if ( issubstr( var_27, "venomx" ) )
                    {
                        var_24 = 1;
                        break;
                    }
                }
            }

            if ( scripts\engine\utility::_id_6E25( "completepuzzles_step4" ) && scripts\engine\utility::_id_9CEE( var_24 ) || scripts\engine\utility::_id_9CEE( level.directors_cut_is_activated ) || scripts\cp\zombies\direct_boss_fight::should_directly_go_to_boss_fight() )
                level thread scripts\cp\maps\cp_final\cp_final_venomx_quest::spawn_egg_interaction_for_players( self.origin );
        }
    }

    _id_0CBC::_id_D97C( var_0, var_1, self, var_6, var_3, var_4 );
    _id_0CBC::_id_D95F( var_1 );
    _id_0A70::_id_12861( var_1, var_4, var_6, var_3, self.agent_type );

    if ( isdefined( level.death_challenge_update_func ) )
        [[ level.death_challenge_update_func ]]( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8 );
    else
        _id_0A4D::_id_12DA9( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8 );

    _id_0A5E::_id_D95D( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8 );

    if ( isdefined( var_1.owner ) )
        var_1.owner _id_0A77::_id_316C( "kill_event_buffered", var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, self.agent_type );
    else if ( isplayer( var_1 ) )
        var_1 _id_0A77::_id_316C( "kill_event_buffered", var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, self.agent_type );

    _id_0A4A::deactivateagent();

    if ( isdefined( level.cp_rave_zombie_death_pos_record_func ) )
        [[ level.cp_rave_zombie_death_pos_record_func ]]( self.origin );

    level thread _id_0A77::add_to_notify_queue( "zombie_killed", self.origin, var_4, var_3, var_1 );
}

should_reset_scriptable_states_on_death()
{
    if ( isdefined( self.agent_type ) )
    {
        switch ( self.agent_type )
        {
            case "generic_zombie":
                return 1;
        }
    }

    return 0;
}

callback_finalzombieplayerdamage( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11 )
{
    var_12 = self;

    if ( !_id_0D4A::_id_100AA( var_2, var_1, var_5, var_3 ) )
        return;

    if ( var_4 == "MOD_SUICIDE" )
    {
        if ( isdefined( level._id_C7E9[var_5] ) )
            level thread [[ level._id_C7E9[var_5] ]]( var_12, var_5 );
    }

    var_13 = isdefined( var_4 ) && ( var_4 == "MOD_EXPLOSIVE" || var_4 == "MOD_GRENADE_SPLASH" || var_4 == "MOD_PROJECTILE_SPLASH" );
    var_14 = isdefined( var_4 ) && var_4 == "MOD_EXPLOSIVE_BULLET";
    var_15 = _id_0D4A::_id_9E06( self, var_1 );
    var_16 = _id_0A77::_id_9BFB();
    var_17 = _id_0A77::_id_8BBE( "perk_machine_boom" );
    var_18 = _id_0A77::_id_8BBE( "perk_machine_change" );
    var_19 = isdefined( var_1 );
    var_20 = var_19 && isdefined( var_1.agent_type ) && ( var_1.agent_type == "generic_zombie" || var_1.agent_type == "skeleton" );
    var_21 = var_19 && var_1 == self;
    var_22 = ( var_21 || !var_19 ) && var_4 == "MOD_SUICIDE";

    if ( var_19 )
    {
        if ( var_1 == self )
        {
            if ( var_13 )
            {
                var_23 = self getstance();

                if ( var_17 )
                    var_2 = 0;
                else if ( isdefined( self.has_fortified_passive ) && self.has_fortified_passive && ( self _meth_81BE() || ( var_23 == "crouch" || var_23 == "prone" ) && self isonground() ) )
                    var_2 = 0;
                else
                    var_2 = _id_0D4A::_id_79A8( var_0, var_1, var_2, var_3, var_4, var_5 );
            }

            switch ( var_5 )
            {
                case "zmb_fireworksprojectile_mp":
                case "zmb_imsprojectile_mp":
                case "iw7_armageddonmeteor_mp":
                    var_2 = 0;
                    break;
                case "iw7_stunbolt_zm":
                case "iw7_bluebolts_zm":
                case "blackhole_grenade_zm":
                case "blackhole_grenade_mp":
                    var_2 = 25;
                    break;
                default:
                    break;
            }
        }
        else if ( var_15 )
        {
            if ( var_16 )
            {
                if ( _id_0A77::_id_9CA6() )
                {
                    if ( isplayer( var_1 ) && isdefined( var_8 ) && var_8 != "shield" )
                    {
                        if ( isdefined( var_0 ) )
                            var_1 _meth_80B0( var_2, var_1.origin - ( 0, 0, 50 ), var_1, var_0, var_4 );
                        else
                            var_1 _meth_80B0( var_2, var_1.origin, var_1 );
                    }

                    var_2 = 0;
                }
            }
            else
                var_2 = 0;
        }
        else if ( var_20 || isdefined( var_1.agent_type ) && var_1.agent_type == "alien_goon" )
        {
            if ( var_4 != "MOD_EXPLOSIVE" && var_12 _id_0A77::_id_9BA0( "burned_out" ) )
            {
                if ( !scripts\engine\utility::_id_9CEE( var_1._id_9B81 ) )
                {
                    var_12 _id_0A77::_id_C151( "burned_out" );
                    var_1 thread _id_0A77::_id_4D0D( var_1, var_12, 3, int( var_1.maxhealth + 1000 ), var_4, "incendiary_ammo_mp", undefined, "burning" );
                    var_1.faf_burned_out = 1;
                }
            }

            var_24 = gettime();

            if ( !isdefined( self._id_A92D ) || var_24 - self._id_A92D > 20 )
                self._id_A92D = var_24;
            else
                return;

            if ( scripts\engine\utility::_id_9CEE( self.back_shield ) )
            {
                var_25 = ( 0, 0, 0 );

                if ( isdefined( var_7 ) )
                {
                    var_25 = var_7;
                    var_26 = anglestoforward( self.angles ) * -1;
                    var_27 = vectordot( var_26, var_25 );

                    if ( var_27 < -0.25 )
                        return;
                }
            }

            var_28 = 500;

            if ( getdvarint( "zom_damage_shield_duration" ) != 0 )
                var_28 = getdvarint( "zom_damage_shield_duration" );

            if ( isdefined( var_1._id_A8A2[self._id_134FD] ) )
            {
                var_29 = var_1._id_A8A2[self._id_134FD];

                if ( var_29 + var_28 > gettime() )
                    var_2 = 0;
                else
                    var_1._id_A8A2[self._id_134FD] = gettime();
            }
            else
                var_1._id_A8A2[self._id_134FD] = gettime();
        }

        if ( var_14 )
        {
            var_23 = self getstance();

            if ( var_17 )
                var_2 = 0;
            else if ( isdefined( self.has_fortified_passive ) && self.has_fortified_passive && ( self _meth_81BE() || ( var_23 == "crouch" || var_23 == "prone" ) && self isonground() ) )
                var_2 = 0;
            else if ( !var_16 || var_1 == self && var_8 == "none" )
                var_2 = 0;
        }
    }
    else if ( var_17 && var_4 == "MOD_SUICIDE" )
    {
        if ( var_5 == "frag_grenade_zm" || var_5 == "cluster_grenade_zm" )
            var_2 = 0;
    }
    else
    {
        var_23 = self getstance();

        if ( isdefined( self.has_fortified_passive ) && self.has_fortified_passive && ( self _meth_81BE() || ( var_23 == "crouch" || var_23 == "prone" ) && self isonground() ) )
        {
            if ( var_5 == "frag_grenade_zm" || var_5 == "cluster_grenade_zm" )
                var_2 = 0;
        }
    }

    if ( var_4 == "MOD_FALLING" )
    {
        if ( _id_0A77::_id_12D6( "specialty_falldamage" ) )
            var_2 = 0;
        else if ( var_2 > 10 )
        {
            if ( var_2 > self.health * 0.15 )
                var_2 = int( self.health * 0.15 );
        }
        else
            var_2 = 0;
    }

    var_30 = 0.0;

    if ( var_19 && var_1 _id_0A77::_id_9D20() && scripts\engine\utility::_id_9CEE( self._id_AD2D ) )
    {
        if ( self.health - var_2 < 1 )
            var_2 = self.health - 1;
    }

    if ( var_20 || var_21 && !var_22 )
        var_2 = int( var_2 * var_12 _id_0A77::_id_7E5C() );

    if ( isdefined( self._id_AD2C ) )
        var_2 = int( max( self.maxhealth / 2.75, var_2 ) );

    if ( var_12 _id_0A77::_id_9BA0( "secret_service" ) && isalive( var_1 ) )
    {
        var_31 = 0;

        if ( isdefined( var_1.agent_type ) && ( var_1.agent_type == "crab_mini" || var_1.agent_type == "crab_brute" || var_1 _id_0A77::agentisfnfimmune() || var_1.agent_type == "alien_goon" ) )
            var_31 = 0;
        else if ( isplayer( var_12 ) && isplayer( var_1 ) )
            var_31 = 0;
        else
            var_31 = 1;

        if ( var_31 )
        {
            var_1 thread _id_0A75::_id_1299C( var_12 );
            var_12 _id_0A77::_id_C151( "secret_service" );
        }
    }

    var_2 = int( var_2 );

    if ( !var_15 || var_16 )
    {
        _id_0D4A::_id_6CE1( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_30, var_10, var_11 );
        thread _id_0A77::add_to_notify_queue( "player_damaged" );
    }

    _id_0A54::_id_12E04( "personal", "damage_taken", var_2 );

    if ( var_2 <= 0 )
        return;

    thread _id_0A77::_id_D222( var_1 );
    thread _id_0D4A::_id_CDBE( self );
    self playlocalsound( "zmb_player_impact_hit" );
    thread _id_0A77::_id_D220();

    if ( var_18 )
        self notify( "change_chews_damage", var_2, self.health );

    if ( isdefined( var_1 ) )
    {
        thread _id_0A58::_id_13F0C();

        if ( isagent( var_1 ) )
        {
            if ( var_2 > self.health )
                var_1.killed_player = 1;

            if ( !isdefined( var_1._id_4CE9 ) )
                var_1._id_4CE9 = 0;
            else
                var_1._id_4CE9 = var_1._id_4CE9 + var_2;

            self._id_DDB9 = var_1;

            if ( isdefined( level._id_4B4A ) )
                self [[ level._id_4C6E ]]( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8 );
        }
    }
}

damage_from_escort_vehicle( var_0, var_1 )
{
    if ( isdefined( var_0 ) && isdefined( var_0._id_0336 ) && var_0._id_0336 == "bomb_vehicle" && isdefined( var_1 ) && var_1 == "MOD_CRUSH" )
        return 1;

    return 0;
}

playbodyfx_ww( var_0, var_1, var_2 )
{
    var_3[0][1]["org"] = self gettagorigin( "j_spinelower" );
    var_3[0][1]["angles"] = self gettagangles( "j_spinelower" );
    var_4 = undefined;
    var_5 = undefined;

    if ( issubstr( var_0, "iw7_harpoon1_zm" ) || issubstr( var_0, "iw7_acid_rain_projectile_zm" ) )
    {
        self hide( 0 );
        var_1._id_C026 = 0;
        var_1._id_74B5 = 0;
        var_3[0][0]["org"] = self gettagorigin( "j_spineupper" );
        var_3[0][0]["angles"] = self gettagangles( "j_spineupper" );
        var_4 = level._effect["wrecked_cheap"];
        var_5 = level._effect["acid_rain_death"];
    }
    else if ( issubstr( var_0, "iw7_harpoon2_zm" ) )
        var_4 = level._effect["wrecked_by_ben"];
    else
        var_4 = level._effect["wrecked_cheap"];

    foreach ( var_7 in var_3 )
    {
        foreach ( var_9 in var_7 )
        {
            if ( ( issubstr( var_0, "iw7_harpoon1_zm" ) || issubstr( var_0, "iw7_acid_rain_projectile_zm" ) ) && !scripts\engine\utility::_id_9CEE( level.played_acid_rain_effect ) )
            {
                level.played_acid_rain_effect = 1;

                if ( isdefined( var_4 ) )
                    playfx( var_4, var_9["org"], anglestoforward( var_9["angles"] ) );

                scripts\engine\utility::waitframe();

                if ( isdefined( var_5 ) )
                {
                    playfx( var_5, var_9["org"] );
                    scripts\engine\utility::waitframe();
                }

                continue;
            }

            if ( ( issubstr( var_0, "iw7_harpoon2_zm" ) || issubstr( var_0, "iw7_harpoon2_zm_stun" ) ) && !scripts\engine\utility::_id_9CEE( level.played_ben_franklin_effect ) )
            {
                level.played_ben_franklin_effect = 1;

                if ( isdefined( var_4 ) )
                    playfx( var_4, var_9["org"], anglestoforward( var_9["angles"] ) );

                scripts\engine\utility::waitframe();
                continue;
            }

            if ( isdefined( var_4 ) )
                playfx( var_4, var_9["org"], anglestoforward( var_9["angles"] ) );

            scripts\engine\utility::waitframe();
        }

        wait 0.01;
    }
}

is_kung_fu_punch( var_0, var_1 )
{
    switch ( var_1 )
    {
        case "iw7_fists_zm_tiger":
        case "iw7_fists_zm_snake":
        case "iw7_fists_zm_dragon":
        case "iw7_fists_zm_crane":
            return 1;
        default:
            break;
    }

    return 0;
}

slasher_processdamagefeedback( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10 )
{
    if ( !scripts\engine\utility::_id_9D74( var_4 ) )
    {
        if ( _id_0A77::_id_9CEB( var_0, var_5 ) )
            return;

        var_11 = gettime();

        if ( isdefined( var_1._id_BF85 ) && var_1._id_BF85 > var_11 )
            return;
        else
            var_1._id_BF85 = var_11 + 250;
    }

    if ( scripts\asm\asm::_id_2354( "block_loop" ) )
        return;

    var_12 = "standard";
    var_13 = undefined;

    if ( var_10.health <= var_2 )
        var_13 = 1;

    var_14 = _id_0A77::isheadshot( var_5, var_8, var_4, var_1 );

    if ( var_14 )
        var_12 = "hitcritical";

    var_15 = scripts\engine\utility::_id_9D74( var_4 );
    var_16 = var_14 && var_1 _id_0A77::_id_9BA0( "sharp_shooter_upgrade" );
    var_17 = var_15 && var_1 _id_0A77::_id_9BA0( "bonus_damage_on_last_bullets" );
    var_18 = var_15 && var_1 _id_0A77::_id_9BA0( "damage_booster_upgrade" );
    var_19 = scripts\engine\utility::_id_9CEE( var_1._id_98F3 );
    var_20 = !var_19 && var_14 && var_15 && var_1 _id_0A77::_id_9BA0( "headshot_explosion" );
    var_21 = !_id_0A77::isreallyalive( var_10 ) || isagent( var_10 ) && var_2 >= var_10.health;
    var_22 = var_4 == "MOD_EXPLOSIVE_BULLET" || var_4 == "MOD_EXPLOSIVE" || var_4 == "MOD_GRENADE_SPLASH" || var_4 == "MOD_PROJECTILE" || var_4 == "MOD_PROJECTILE_SPLASH";
    var_23 = var_4 == "MOD_MELEE";

    if ( scripts\engine\utility::_id_9CEE( var_10.armor_hit ) )
        var_12 = "hitalienarmor";
    else if ( var_16 || var_17 || var_18 || var_20 )
        var_12 = "card_boosted";
    else if ( isplayer( var_1 ) && var_1 _id_0A77::_id_8BBE( "perk_machine_boom" ) && var_22 )
        var_12 = "high_damage";
    else if ( isplayer( var_1 ) && var_1 _id_0A77::_id_8BBE( "perk_machine_smack" ) && var_23 )
        var_12 = "high_damage";
    else if ( isplayer( var_1 ) && var_1 _id_0A77::_id_8BBE( "perk_machine_rat_a_tat" ) && var_15 )
        var_12 = "high_damage";
    else if ( isplayer( var_1 ) && scripts\engine\utility::_id_9CEE( var_1.deadeye_charge ) && var_15 )
        var_12 = "special_weapon";

    if ( isdefined( var_1 ) )
    {
        if ( isdefined( var_1.owner ) )
            var_1.owner thread _id_0A4F::updatedamagefeedback( var_12, var_13, var_2, var_10._id_E54C );
        else
            var_1 thread _id_0A4F::updatedamagefeedback( var_12, var_13, var_2, var_10._id_E54C );
    }

    if ( scripts\engine\utility::_id_9CEE( self.armor_hit ) )
        self.armor_hit = 0;
}

change_chews_damage_over_time( var_0, var_1, var_2, var_3 )
{
    var_4 = var_2 * var_2;
    var_5 = var_0.origin;
    var_6 = sortbydistance( level._id_1084F, var_1.origin );
    var_7 = 0;

    foreach ( var_9 in var_6 )
    {
        if ( var_9 == var_0 )
            continue;

        if ( isdefined( var_9.chew_effect_time ) && var_9.chew_effect_time == gettime() )
            continue;

        if ( isdefined( var_9.agent_type ) && var_9.agent_type != "generic_zombie" )
            continue;

        if ( distancesquared( var_5, var_9.origin ) < var_4 )
        {
            var_9.chew_effect_time = gettime();
            var_7++;

            switch ( var_3 )
            {
                case "frozen":
                    var_9 thread change_chews_frozen_damage( var_1, var_5 );

                    if ( var_7 >= 6 )
                        return;

                    break;
                case "burning":
                    var_9 thread change_chews_fire_damage( var_1, var_5 );

                    if ( var_7 >= 8 )
                        return;

                    break;
                case "shocked":
                    var_9 thread change_chews_shock_damage( var_1, var_5 );

                    if ( var_7 >= 10 )
                        return;

                    break;
                case "explode":
                    var_9 thread change_chews_explosive_damage( var_1, var_5 );

                    if ( var_7 >= 5 )
                        return;

                    break;
                default:
                    break;
            }

            wait 0.1;
            continue;
        }

        wait 0.1;
    }
}

change_chews_frozen_damage( var_0, var_1 )
{
    self endon( "death" );
    self._id_9E0C = 1;
    var_2 = self.health;
    self.health = 1;
    wait 10;
    self._id_9E0C = undefined;

    if ( var_2 > 0 )
        self.health = var_2;
}

change_chews_fire_damage( var_0, var_1 )
{
    self endon( "death" );

    if ( isalive( self ) && !scripts\engine\utility::_id_9CEE( self._id_B36E ) )
    {
        self._id_B36E = 1;
        thread _id_0A77::_id_4D0D( self, var_0, 5, 1900, undefined, "iw7_fwoosh_zm", 0, "burning", "fwoosh_kill" );
    }
}

change_chews_shock_damage( var_0, var_1 )
{
    self endon( "death" );
    thread _id_0D5D::_id_13E63( 2, var_0 );
}

change_chews_explosive_damage( var_0, var_1 )
{
    self _meth_80B0( self.health + 1000, var_1, var_0, var_0, "MOD_EXPLOSIVE", "iw7_change_chews_zm" );
}

iscrog( var_0 )
{
    return isdefined( var_0.agent_type ) && ( var_0.agent_type == "crab_brute" || var_0.agent_type == "crab_mini" );
}
