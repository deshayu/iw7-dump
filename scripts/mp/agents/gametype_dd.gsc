// IW7 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

main()
{
    setup_callbacks();
    _id_F8DA();
}

setup_callbacks()
{
    level.bot_funcs["crate_can_use"] = ::_id_4830;
    level.bot_funcs["gametype_think"] = ::_id_2D59;
}

_id_4830( var_0 )
{
    if ( isagent( self ) && !isdefined( var_0.boxtype ) )
        return 0;

    if ( isdefined( var_0._id_485F ) && !scripts\mp\bots\bots_killstreaks::_id_2DDB( var_0._id_485F ) )
        return 0;

    return _id_9C96();
}

_id_B9B0()
{
    self notify( "monitor_zone_control" );
    self endon( "monitor_zone_control" );
    self endon( "death" );
    level endon( "game_ended" );

    for (;;)
    {
        wait 1;
        var_0 = getzonenearest( self.curorigin );

        if ( isdefined( var_0 ) )
        {
            if ( self._id_2C5C )
                var_1 = scripts\engine\utility::_id_7984( self._id_C83E );
            else
                var_1 = self._id_C83E;

            if ( var_1 != "neutral" )
                botzonesetteam( var_0, var_1 );
        }
    }
}

iw7_ship_hack_add_bombzone_node( var_0, var_1 )
{
    var_2 = spawnstruct();
    var_2.origin = var_1;
    var_2.angles = ( 0, randomint( 360 ), 0 );
    level._id_2C7A[var_0]._id_2EFE[level._id_2C7A[var_0]._id_2EFE.size] = var_2;
}

bot_fixup_bombzone_issues()
{
    if ( level._id_B335 == "mp_metropolis" )
    {
        if ( scripts\mp\utility\game::_id_9900() && level._id_2C7A[0]._id_2EFE.size == 0 )
        {
            var_0 = ( -505, -361, 68 );
            iw7_ship_hack_add_bombzone_node( 0, var_0 );
            var_0 = ( -582, -311, 68 );
            iw7_ship_hack_add_bombzone_node( 0, var_0 );
            var_0 = ( -583, -387, 68 );
            iw7_ship_hack_add_bombzone_node( 0, var_0 );
            var_0 = ( -583, -387, 68 );
            iw7_ship_hack_add_bombzone_node( 0, var_0 );
            var_0 = ( -497, -326, 68 );
            iw7_ship_hack_add_bombzone_node( 0, var_0 );
        }
    }
}

_id_F8DA()
{
    scripts\mp\bots\bots_util::_id_2ECA();
    scripts\mp\bots\bots_strategy::_id_2E86();
    bot_fixup_bombzone_issues();

    foreach ( var_1 in level._id_2C7A )
    {
        foreach ( var_3 in var_1._id_2EFE )
        {
            var_4 = scripts\engine\utility::_id_22A7( var_1._id_2EFE );
            var_1._id_2EFD = var_4[0];
            break;
        }
    }

    scripts\mp\bots\bots_util::_id_2D19();

    foreach ( var_1 in level._id_2C7A )
        var_1 thread _id_B9B0();

    level._id_2DA1 = 1;
}

getovertimebombzone()
{
    return level._id_2C7A[0];
}

isattacker()
{
    if ( !scripts\mp\utility\game::_id_9900() )
    {
        if ( self.team == game["attackers"] )
            return 1;

        return 0;
    }

    var_0 = getovertimebombzone();

    if ( var_0._id_C83E == "neutral" )
        return 1;

    if ( var_0._id_C83E == self.team )
        return 0;

    return 1;
}

isdefender()
{
    if ( !scripts\mp\utility\game::_id_9900() )
    {
        if ( self.team == game["defenders"] )
            return 1;

        return 0;
    }

    var_0 = getovertimebombzone();

    if ( var_0._id_C83E == "neutral" )
        return 0;

    if ( var_0._id_C83E == self.team )
        return 1;

    return 0;
}

_id_2D59()
{
    self notify( "bot_dem_think" );
    self endon( "bot_dem_think" );
    self endon( "death" );
    self endon( "disconnect" );
    level endon( "game_ended" );

    while ( !isdefined( level._id_2DA1 ) )
        wait 0.05;

    _id_9558();
    self botsetflag( "separation", 0 );
    self botsetflag( "grenade_objectives", 1 );
    self botsetflag( "use_obj_path_style", 1 );
    self._id_9BB6 = 0;
    self._id_9C6A = 0;
    self._id_4B48 = undefined;

    if ( !isdefined( level._id_BF3F ) )
        level._id_BF3F = gettime() - 100;

    for (;;)
    {
        wait 0.05;

        if ( gettime() >= level._id_BF3F )
        {
            _id_12DC2();
            level._id_BF3F = gettime() + 100;
        }

        if ( self.health <= 0 )
            continue;

        if ( scripts\mp\utility\game::_id_9900() && !isdefined( self._id_4B48 ) )
            self._id_4B48 = getovertimebombzone();

        if ( isattacker() )
        {
            if ( self._id_9C6A )
                _id_CC49();
            else
            {
                if ( !isdefined( self._id_4B48 ) )
                    self._id_4B48 = _id_6C7A( "attackers" );

                if ( isdefined( self._id_4B48 ) )
                {
                    if ( _id_9B7E( self._id_4B48 ) && !_id_9C96() )
                        scripts\mp\bots\bots_strategy::_id_2E57( self._id_4B48._id_2EFD.origin, 600 );
                    else if ( !_id_9B7E( self._id_4B48 ) && !_id_9B84() )
                    {
                        var_0["entrance_points_index"] = "zone" + self._id_4B48._id_01AD;
                        scripts\mp\bots\bots_strategy::_id_2D2B( self._id_4B48._id_2EFD.origin, 350, var_0 );
                    }
                }
            }

            continue;
        }

        if ( self._id_9BB6 )
        {
            if ( !isdefined( level._id_4DA4[self._id_4B48._id_01AD] ) )
                self._id_9BB6 = 0;
        }

        if ( self._id_9BB6 )
        {
            _id_50A6();
            continue;
        }

        if ( !isdefined( self._id_4B48 ) )
            self._id_4B48 = _id_6C7A( "defenders" );

        if ( isdefined( self._id_4B48 ) )
        {
            if ( _id_9B7E( self._id_4B48 ) && !_id_9B84() )
            {
                var_0["entrance_points_index"] = "zone" + self._id_4B48._id_01AD;
                scripts\mp\bots\bots_strategy::_id_2D2B( self._id_4B48._id_2EFD.origin, 350, var_0 );
                continue;
            }

            if ( !_id_9B7E( self._id_4B48 ) && !_id_9C96() )
                scripts\mp\bots\bots_strategy::_id_2E57( self._id_4B48._id_2EFD.origin, 600 );
        }
    }
}

_id_CC49()
{
    _id_8466( 1 );
}

_id_50A6()
{
    _id_8466( 0 );
}

_id_8466( var_0 )
{
    scripts\mp\bots\bots_strategy::_id_2D4E();

    if ( var_0 )
        self botsetscriptgoal( self._id_4B48._id_2EFD.origin, 20, "critical", self._id_4B48._id_2EFD.angles[1] );
    else
    {
        var_1 = level._id_4DA4[self._id_4B48._id_01AD].origin;
        self botsetscriptgoal( var_1, 20, "critical" );
    }

    var_2 = scripts\mp\bots\bots_util::_id_2ECB( undefined, "dem_bomb_exploded", "no_longer_bomb_defuser" );

    if ( var_2 == "goal" )
    {
        self botpressbutton( "use", level._id_50AB + 2 );
        _id_1381B( level._id_50AB + 2, var_0 );

        if ( var_0 )
            self._id_9C6A = 0;
        else
            self._id_9BB6 = 0;
    }
}

_id_1381B( var_0, var_1 )
{
    var_2 = gettime();
    var_3 = var_2 + var_0 * 1000;
    wait 0.05;

    while ( self usebuttonpressed() && gettime() < var_3 && isdefined( self._id_4B48 ) && var_1 != _id_9B7E( self._id_4B48 ) )
        wait 0.05;
}

_id_9C96()
{
    return scripts\mp\bots\bots_util::_id_2DDD();
}

_id_9B84()
{
    return scripts\mp\bots\bots_util::_id_2DD5();
}

_id_787A( var_0, var_1 )
{
    var_2 = [];

    foreach ( var_4 in level._id_C928 )
    {
        if ( var_1 == "attackers" && !var_4 isattacker() )
            continue;

        if ( var_1 == "defenders" && !var_4 isdefender() )
            continue;

        if ( isalive( var_4 ) && scripts\mp\utility\game::_id_9F9D( var_4 ) && isdefined( var_4._id_4B48 ) && var_4._id_4B48 == var_0 )
            var_2[var_2.size] = var_4;
    }

    return var_2;
}

_id_7877( var_0 )
{
    var_1 = _id_787A( var_0, "defenders" );

    foreach ( var_3 in var_1 )
    {
        if ( var_3._id_9BB6 )
            return var_3;
    }

    return undefined;
}

_id_7878( var_0 )
{
    var_1 = _id_787A( var_0, "attackers" );

    foreach ( var_3 in var_1 )
    {
        if ( var_3._id_9C6A )
            return var_3;
    }

    return undefined;
}

_id_6C7A( var_0 )
{
    var_1 = [];

    foreach ( var_3 in level._id_2C7A )
    {
        if ( !scripts\engine\utility::_id_9CEE( var_3._id_2C58 ) )
        {
            var_4 = 0;

            if ( var_0 == "defenders" )
                var_4 = var_3._id_2EED > _id_787A( var_3, "defenders" ).size;
            else if ( var_0 == "attackers" )
                var_4 = var_3._id_2EEC > _id_787A( var_3, "attackers" ).size;

            if ( var_4 )
                var_1[var_1.size] = var_3;
        }
    }

    var_6 = undefined;

    if ( var_1.size > 0 )
    {
        var_7 = 999999999;

        foreach ( var_3 in var_1 )
        {
            var_9 = distancesquared( var_3._id_2EFD.origin, self.origin );

            if ( var_9 < var_7 )
            {
                var_6 = var_3;
                var_7 = var_9;
            }
        }
    }

    return var_6;
}

_id_12DC2()
{
    var_0 = [];

    foreach ( var_2 in level._id_2C7A )
    {
        if ( !scripts\engine\utility::_id_9CEE( var_2._id_2C58 ) )
            var_0[var_0.size] = var_2;
    }

    if ( level._id_D88D == 2 && var_0.size == 1 )
    {
        foreach ( var_5 in level._id_C928 )
        {
            if ( scripts\mp\utility\game::_id_9F9D( var_5 ) && isdefined( var_5._id_4B48 ) && var_5._id_4B48 != var_0[0] )
            {
                var_5._id_4B48 = undefined;
                var_5 scripts\mp\bots\bots_strategy::_id_2D4E();
                var_5 notify( "dem_bomb_exploded" );
                var_5._id_9BB6 = 0;
                var_5._id_9C6A = 0;
            }
        }

        level._id_D88D = 1;
    }

    _id_12DAD( var_0 );
    _id_12DAE( var_0 );
}

_id_12DAD( var_0 )
{
    if ( gettime() > level._id_BF62 )
    {
        level._id_4BD6 = 1 - level._id_4BD6;
        level._id_BF62 = gettime() + 90000;
    }

    var_1 = 0;

    foreach ( var_3 in level._id_C928 )
    {
        if ( scripts\mp\utility\game::_id_9D36( var_3 ) && isalive( var_3 ) && var_3 isattacker() )
            var_1++;
    }

    if ( var_0.size == 2 )
    {
        if ( var_1 >= 2 )
            var_0[1 - level._id_4BD6]._id_2EEC = 1;
        else
            var_0[1 - level._id_4BD6]._id_2EEC = 0;

        var_0[level._id_4BD6]._id_2EEC = var_1 - var_0[1 - level._id_4BD6]._id_2EEC;
    }
    else if ( var_0.size == 1 )
        var_0[0]._id_2EEC = var_1;

    foreach ( var_6 in var_0 )
    {
        var_7 = _id_787A( var_6, "attackers" );

        if ( var_7.size > var_6._id_2EEC )
        {
            var_7 = scripts\engine\utility::_id_22A7( var_7 );

            foreach ( var_9 in var_7 )
            {
                if ( !var_9._id_9C6A )
                {
                    var_9._id_4B48 = undefined;
                    var_9 scripts\mp\bots\bots_strategy::_id_2D4E();
                    break;
                }
            }
        }
    }

    foreach ( var_6 in var_0 )
    {
        if ( !_id_9B7E( var_6 ) && !isdefined( _id_7878( var_6 ) ) )
        {
            var_7 = _id_787A( var_6, "attackers" );

            if ( var_7.size > 0 )
            {
                var_13 = scripts\engine\utility::_id_782F( var_6._id_2EFD.origin, var_7 );
                var_13[0]._id_9C6A = 1;
                var_13[0] scripts\mp\bots\bots_strategy::_id_2D4E();
            }
        }
    }
}

_id_12DAE( var_0 )
{
    var_1 = 0;

    foreach ( var_3 in level._id_C928 )
    {
        if ( scripts\mp\utility\game::_id_9D36( var_3 ) && isalive( var_3 ) && var_3 isdefender() )
            var_1++;
    }

    if ( var_0.size == 2 )
    {
        var_0[0]._id_2EED = int( var_1 / 2 );
        var_0[1]._id_2EED = int( var_1 / 2 );
        var_0[level._id_BB52]._id_2EED = var_0[level._id_BB52]._id_2EED + var_1 % 2;

        for ( var_5 = 0; var_5 < var_0.size; var_5++ )
        {
            if ( _id_9B7E( var_0[var_5] ) )
            {
                var_0[var_5]._id_2EED++;
                var_0[1 - var_5]._id_2EED--;
            }
        }
    }
    else if ( var_0.size == 1 )
        var_0[0]._id_2EED = var_1;

    foreach ( var_7 in var_0 )
    {
        var_8 = _id_787A( var_7, "defenders" );

        if ( var_8.size > var_7._id_2EED )
        {
            var_8 = scripts\engine\utility::_id_22A7( var_8 );

            foreach ( var_10 in var_8 )
            {
                if ( !var_10._id_9BB6 )
                {
                    var_10._id_4B48 = undefined;
                    var_10 scripts\mp\bots\bots_strategy::_id_2D4E();
                    break;
                }
            }
        }
    }

    foreach ( var_7 in var_0 )
    {
        if ( _id_9B7E( var_7 ) )
        {
            var_14 = _id_7877( var_7 );

            if ( !isdefined( var_14 ) || gettime() > level._id_BF6A )
            {
                var_8 = _id_787A( var_7, "defenders" );

                if ( var_8.size > 0 )
                {
                    var_15 = scripts\engine\utility::_id_782F( var_7._id_2EFD.origin, var_8 );

                    if ( !isdefined( var_14 ) || var_15[0] != var_14 )
                    {
                        var_15[0]._id_9BB6 = 1;
                        var_15[0] scripts\mp\bots\bots_strategy::_id_2D4E();

                        if ( isdefined( var_14 ) )
                        {
                            var_14._id_9BB6 = 0;
                            var_14 notify( "no_longer_bomb_defuser" );
                        }
                    }
                }

                level._id_BF6A = gettime() + 2500;
            }
        }
    }
}

_id_9B7E( var_0 )
{
    return isdefined( var_0._id_2C5C ) && var_0._id_2C5C == 1;
}

_id_9558()
{
    if ( isdefined( level._id_2EF4 ) && level._id_2EF4 )
        return;

    level._id_2EF4 = 1;
    level._id_BB52 = randomint( 2 );
    level._id_D88D = 2;
    level._id_4BD6 = randomint( 2 );
    level._id_BF62 = gettime() + 90000;
    level._id_BF6A = 0;
}
