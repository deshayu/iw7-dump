// IW7 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

main()
{
    setup_callbacks();
    _id_F8D6();
    thread monitor_ball_carrier();
}

setup_callbacks()
{
    level.bot_funcs["gametype_think"] = ::_id_2D12;
}

_id_F8D6()
{
    scripts\mp\bots\bots_util::_id_2ECA( 1 );
    level._id_DAA3 = 600;
    level._id_2C12 = 400;
    thread _id_2D11();
    level._id_2DA1 = 1;
}

_id_2DA4()
{
    foreach ( var_1 in level._id_2800 )
    {
        if ( isdefined( var_1._id_3AA8 ) )
            continue;

        if ( scripts\engine\utility::_id_9CEE( var_1._id_9398 ) )
            continue;

        if ( scripts\engine\utility::_id_9CEE( var_1._id_9F24 ) )
            continue;

        return var_1;
    }

    return undefined;
}

_id_2DA5()
{
    foreach ( var_1 in level._id_2800 )
    {
        if ( isdefined( var_1._id_3AA8 ) )
            return var_1._id_3AA8;
    }

    return undefined;
}

_id_2D5D()
{
    self endon( "death" );
    self endon( "disconnect" );
    level endon( "game_ended" );
    self botsetstance( "stand" );

    for ( var_0 = 0; var_0 < 5; var_0++ )
    {
        self botpressbutton( "jump" );
        scripts\engine\utility::waitframe();
    }

    scripts\engine\utility::waitframe();
    scripts\engine\utility::waitframe();

    for ( var_0 = 0; var_0 < 60; var_0++ )
    {
        self botpressbutton( "jump" );
        scripts\engine\utility::waitframe();

        if ( !isdefined( self.carryobject ) )
            break;
    }
}

bot_throw_ball()
{
    self endon( "death" );
    self endon( "disconnect" );
    level endon( "game_ended" );

    for ( var_0 = 0; var_0 < 5; var_0++ )
    {
        self botpressbutton( "attack" );
        scripts\engine\utility::waitframe();
    }
}

_id_2DA7()
{
    if ( self.team == "allies" )
        return "axis";

    return "allies";
}

_id_2D12()
{
    self notify( "bot_ball_think" );
    self endon( "bot_ball_think" );
    self endon( "death" );
    self endon( "disconnect" );
    level endon( "game_ended" );

    while ( !isdefined( level._id_2DA1 ) )
        wait 0.05;

    self botsetflag( "separation", 0 );
    var_0 = undefined;
    var_1 = undefined;

    for (;;)
    {
        wait 0.05;

        if ( !isdefined( self._id_E67C ) )
        {
            _id_9841();
            var_0 = undefined;
        }

        if ( scripts\mp\bots\bots_strategy::_id_2DC5() )
        {
            var_0 = undefined;
            continue;
        }

        if ( self._id_E67C != "carrier" && isdefined( self.carryobject ) )
        {
            var_0 = undefined;
            _id_27C2( "carrier" );
        }

        if ( self._id_E67C == "carrier" )
        {
            if ( isdefined( self.carryobject ) )
            {
                self botsetflag( "disable_attack", 1 );
                var_2 = 0;

                if ( isdefined( self._id_010C ) )
                    var_2 = distancesquared( self._id_010C.origin, self.origin );

                if ( isdefined( self._id_010C ) && var_2 < 9216 )
                {
                    self botsetflag( "disable_attack", 0 );
                    self botsetflag( "prefer_melee", 1 );
                }
                else
                {
                    self botsetflag( "prefer_melee", 0 );
                    self botsetflag( "disable_attack", 1 );
                }

                if ( isdefined( level._id_2798 ) )
                {
                    var_3 = level._id_2798[_id_2DA7()].origin;

                    if ( !isdefined( var_0 ) )
                    {
                        var_0 = getclosestpointonnavmesh( var_3, self );

                        if ( distance2dsquared( var_0, var_3 ) > 256 )
                        {
                            var_4 = ( var_3[0], var_3[1], var_3[2] - 90 );
                            var_0 = getclosestpointonnavmesh( var_4, self );
                        }
                    }

                    self botsetscriptgoal( var_0, 16, "critical" );
                    var_5 = distance2dsquared( self.origin, var_3 );

                    if ( var_5 < 30625 )
                    {
                        var_6 = self geteye();
                        var_7 = var_3;

                        if ( scripts\engine\trace::_id_DCF1( var_6, var_7, self ) )
                        {
                            if ( var_5 < 256 )
                            {
                                self botsetscriptgoal( self.origin, 16, "critical" );
                                wait 0.25;
                            }

                            _id_2D5D();
                            wait 0.2;

                            if ( !isdefined( self.carryobject ) )
                                self botclearscriptgoal();
                        }
                    }
                }
                else
                {
                    self botclearscriptgoal();

                    if ( !isdefined( var_1 ) )
                        var_1 = gettime() + randomintrange( 500, 1000 );

                    if ( gettime() > var_1 )
                    {
                        var_1 = gettime() + randomintrange( 500, 1000 );

                        if ( isdefined( self._id_010C ) )
                        {
                            if ( self botcanseeentity( self._id_010C ) )
                            {
                                var_8 = anglestoforward( self.angles );
                                var_9 = self._id_010C.origin - self.origin;
                                var_10 = vectornormalize( ( var_9[0], var_9[1], 0 ) );
                                var_11 = vectordot( var_8, var_10 );

                                if ( var_11 > 0.707 )
                                {
                                    if ( var_2 < 57600 && var_2 > 9216 )
                                        bot_throw_ball();
                                }
                            }
                        }
                    }
                }
            }
            else
            {
                self botsetflag( "disable_attack", 0 );
                self botsetflag( "prefer_melee", 0 );
                var_12 = _id_2DA4();

                if ( !isdefined( var_12 ) )
                {
                    var_13 = _id_2DA5();

                    if ( isdefined( var_13 ) && var_13 != self )
                        _id_9841();
                }
                else
                {
                    self botsetscriptgoal( var_12.curorigin, 16, "objective" );
                    continue;
                }
            }
        }
        else
            var_0 = undefined;

        if ( self._id_E67C == "attacker" )
        {
            self botsetflag( "disable_attack", 0 );
            self botsetflag( "prefer_melee", 0 );
            var_12 = _id_2DA4();

            if ( !isdefined( var_12 ) )
            {
                var_13 = _id_2DA5();

                if ( isdefined( var_13 ) )
                {
                    if ( !scripts\mp\bots\bots_util::_id_2DDA( var_13 ) )
                        scripts\mp\bots\bots_strategy::_id_2DC1( var_13, level._id_2C12 );
                }
            }
            else if ( !scripts\engine\utility::_id_9CEE( var_12._id_9F24 ) && !scripts\engine\utility::_id_9CEE( var_12._id_9398 ) )
            {
                var_14 = getclosestpointonnavmesh( var_12.curorigin );

                if ( !scripts\mp\bots\bots_util::_id_2DD8( var_14 ) )
                    scripts\mp\bots\bots_strategy::_id_2E57( var_14, level._id_DAA3 );
            }

            continue;
        }

        if ( self._id_E67C == "defender" )
        {
            self botsetflag( "disable_attack", 0 );
            self botsetflag( "prefer_melee", 0 );
            var_15 = level._id_2798[self.team];
            var_3 = var_15.origin;

            if ( !scripts\mp\bots\bots_util::_id_2DD8( var_3 ) )
                scripts\mp\bots\bots_strategy::_id_2E57( var_3, level._id_DAA3 );
        }
    }
}

_id_9841()
{
    var_0 = _id_7809( self.team );
    var_1 = _id_780A( self.team );
    var_2 = _id_2774( self.team );
    var_3 = _id_2775( self.team );
    var_4 = level._id_2E46[self.personality];

    if ( var_4 == "active" )
    {
        if ( var_0.size >= var_2 )
        {
            var_5 = 0;

            foreach ( var_7 in var_0 )
            {
                if ( isai( var_7 ) && level._id_2E46[var_7.personality] == "stationary" )
                {
                    var_7._id_E67C = undefined;
                    var_5 = 1;
                    break;
                }
            }

            if ( var_5 )
            {
                _id_27C2( "attacker" );
                return;
            }

            _id_27C2( "defender" );
            return;
        }
        else
            _id_27C2( "attacker" );
    }
    else if ( var_4 == "stationary" )
    {
        if ( var_1.size >= var_3 )
        {
            var_5 = 0;

            foreach ( var_10 in var_1 )
            {
                if ( isai( var_10 ) && level._id_2E46[var_10.personality] == "active" )
                {
                    var_10._id_E67C = undefined;
                    var_5 = 1;
                    break;
                }
            }

            if ( var_5 )
            {
                _id_27C2( "defender" );
                return;
            }

            _id_27C2( "attacker" );
            return;
        }
        else
            _id_27C2( "defender" );
    }
}

_id_2D11()
{
    level notify( "bot_ball_ai_director_update" );
    level endon( "bot_ball_ai_director_update" );
    level endon( "game_ended" );
    var_0[0] = "allies";
    var_0[1] = "axis";
    var_1 = [];

    for (;;)
    {
        foreach ( var_3 in var_0 )
        {
            var_4 = _id_2774( var_3 );
            var_5 = _id_2775( var_3 );
            var_6 = _id_7809( var_3 );
            var_7 = _id_780A( var_3 );

            if ( var_6.size > var_4 )
            {
                var_8 = [];
                var_9 = 0;

                foreach ( var_11 in var_6 )
                {
                    if ( isai( var_11 ) )
                    {
                        if ( level._id_2E46[var_11.personality] == "stationary" )
                        {
                            var_11 _id_27C2( "defender" );
                            var_9 = 1;
                            break;
                        }
                        else
                            var_8 = scripts\engine\utility::_id_2279( var_8, var_11 );
                    }
                }

                if ( !var_9 && var_8.size > 0 )
                    scripts\engine\utility::_id_DC6B( var_8 ) _id_27C2( "defender" );
            }

            if ( var_7.size > var_5 )
            {
                var_13 = [];
                var_14 = 0;

                foreach ( var_16 in var_7 )
                {
                    if ( isai( var_16 ) )
                    {
                        if ( level._id_2E46[var_16.personality] == "active" )
                        {
                            var_16 _id_27C2( "attacker" );
                            var_14 = 1;
                            break;
                        }
                        else
                            var_13 = scripts\engine\utility::_id_2279( var_13, var_16 );
                    }
                }

                if ( !var_14 && var_13.size > 0 )
                    scripts\engine\utility::_id_DC6B( var_13 ) _id_27C2( "attacker" );
            }

            var_18 = _id_2DA4();

            if ( isdefined( var_18 ) )
            {
                var_19 = _id_CB1C( var_3, var_18 );

                if ( isdefined( var_19 ) && isdefined( var_19._id_E67C ) && var_19._id_E67C != "carrier" )
                {
                    if ( !isdefined( var_19.carryobject ) )
                    {
                        var_20 = var_1[var_3];

                        if ( isdefined( var_20 ) )
                            var_20 _id_27C2( undefined );

                        var_19 _id_27C2( "carrier" );
                        var_1[var_19.team] = var_19;
                    }
                }
            }
        }

        wait 1.0;
    }
}

_id_2774( var_0 )
{
    var_1 = _id_2790( var_0 );

    if ( !isdefined( level._id_2798 ) )
        return var_1;

    return int( int( var_1 ) / 2 ) + 1 + int( var_1 ) % 2;
}

_id_2775( var_0 )
{
    if ( !isdefined( level._id_2798 ) )
        return 0;

    var_1 = _id_2790( var_0 );
    return max( int( int( var_1 ) / 2 ) - 1, 0 );
}

_id_2790( var_0 )
{
    var_1 = 0;

    foreach ( var_3 in level._id_C928 )
    {
        if ( scripts\mp\utility\game::_id_9F9D( var_3 ) && isdefined( var_3.team ) && var_3.team == var_0 )
            var_1++;
    }

    return var_1;
}

_id_CB1C( var_0, var_1 )
{
    var_2 = undefined;
    var_3 = undefined;

    foreach ( var_5 in level._id_C928 )
    {
        if ( !isdefined( var_5.team ) )
            continue;

        if ( var_5.team != var_0 )
            continue;

        if ( !isalive( var_5 ) )
            continue;

        if ( !isai( var_5 ) )
            continue;

        if ( isdefined( var_5._id_E67C ) && var_5._id_E67C == "defender" )
            continue;

        var_6 = distancesquared( var_5.origin, var_1.curorigin );

        if ( !isdefined( var_3 ) || var_6 < var_3 )
        {
            var_3 = var_6;
            var_2 = var_5;
        }
    }

    if ( isdefined( var_2 ) )
        return var_2;

    return undefined;
}

_id_7809( var_0 )
{
    var_1 = _id_7BBE( "attacker", var_0 );

    if ( isdefined( level._id_2798 ) )
    {
        foreach ( var_3 in level.players )
        {
            if ( !isai( var_3 ) && isdefined( var_3.team ) && var_3.team == var_0 )
            {
                if ( distancesquared( level._id_2798[var_0].origin, var_3.origin ) > level._id_DAA3 * level._id_DAA3 )
                    var_1 = scripts\engine\utility::_id_2279( var_1, var_3 );
            }
        }
    }

    return var_1;
}

_id_780A( var_0 )
{
    var_1 = _id_7BBE( "defender", var_0 );

    if ( isdefined( level._id_2798 ) )
    {
        foreach ( var_3 in level.players )
        {
            if ( !isai( var_3 ) && isdefined( var_3.team ) && var_3.team == var_0 )
            {
                if ( distancesquared( level._id_2798[var_0].origin, var_3.origin ) <= level._id_DAA3 * level._id_DAA3 )
                    var_1 = scripts\engine\utility::_id_2279( var_1, var_3 );
            }
        }
    }

    return var_1;
}

_id_27C2( var_0 )
{
    self._id_E67C = var_0;
    self botclearscriptgoal();
    scripts\mp\bots\bots_strategy::_id_2D4E();
}

_id_7BBE( var_0, var_1 )
{
    var_2 = [];

    foreach ( var_4 in level._id_C928 )
    {
        if ( !isdefined( var_4.team ) )
            continue;

        if ( isalive( var_4 ) && scripts\mp\utility\game::_id_9F9D( var_4 ) && var_4.team == var_1 && isdefined( var_4._id_E67C ) && var_4._id_E67C == var_0 )
            var_2[var_2.size] = var_4;
    }

    return var_2;
}

monitor_ball_carrier()
{
    level endon( "game_ended" );
    var_0 = undefined;

    for (;;)
    {
        var_1 = _id_2DA5();

        if ( !isdefined( var_0 ) || !isdefined( var_1 ) || var_1 != var_0 )
        {
            if ( isdefined( var_0 ) && var_0._id_033F == 505 )
                var_0._id_033F = 0;

            var_0 = var_1;
        }

        if ( isdefined( var_1 ) && var_1._id_033F == 0 )
            var_1._id_033F = 505;

        wait 0.05;
    }
}
